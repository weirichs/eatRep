<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Replication methods (JK1, JK2 and BRR) for descriptive statistics. — repMean • eatRep</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Replication methods (JK1, JK2 and BRR) for descriptive statistics. — repMean"><meta property="og:description" content="Compute totals, means, adjusted means, mean differences, variances and standard deviations
with standard errors in random or clustered or complex samples. Variance estimation in complex cluster
designs based on Jackknife (JK1, JK2) or Balanced Repeated Replicates (BRR) procedure. Moreover, analyses
can be customized for multiple or nested imputed variables, applying the combination rules of Rubin (1987)
for imputed data and Rubin (2003) for nested imputed data. Conceptually, the function combines replication
methods and methods for multiple imputed data. Trend estimation as usual in large-scale assessments is supported as well.
Technically, this is a wrapper for the svymean and svyvar functions of the survey package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eatRep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/eatRep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/weirichs/eatRep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Replication methods (JK1, JK2 and BRR) for descriptive statistics.</h1>

    <div class="hidden name"><code>repMean.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute totals, means, adjusted means, mean differences, variances and standard deviations
with standard errors in random or clustered or complex samples. Variance estimation in complex cluster
designs based on Jackknife (JK1, JK2) or Balanced Repeated Replicates (BRR) procedure. Moreover, analyses
can be customized for multiple or nested imputed variables, applying the combination rules of Rubin (1987)
for imputed data and Rubin (2003) for nested imputed data. Conceptually, the function combines replication
methods and methods for multiple imputed data. Trend estimation as usual in large-scale assessments is supported as well.
Technically, this is a wrapper for the <code><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a></code> and <code><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svyvar</a></code> functions of the <code>survey</code> package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">repMean</span> <span class="op">(</span><span class="va">datL</span>, <span class="va">ID</span>, wgt <span class="op">=</span> <span class="cn">NULL</span>, type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"JK2"</span>, <span class="st">"JK1"</span>, <span class="st">"BRR"</span>, <span class="st">"Fay"</span><span class="op">)</span>, PSU <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>         repInd <span class="op">=</span> <span class="cn">NULL</span>, jkfac<span class="op">=</span><span class="cn">NULL</span>, repWgt <span class="op">=</span> <span class="cn">NULL</span>, nest<span class="op">=</span><span class="cn">NULL</span>, imp<span class="op">=</span><span class="cn">NULL</span>, groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>         group.splits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span>, group.differences.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>         cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, crossDiffSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wec"</span>, <span class="st">"rep"</span>,<span class="st">"old"</span><span class="op">)</span>,</span>
<span>         adjust <span class="op">=</span> <span class="cn">NULL</span>, useEffectLiteR <span class="op">=</span> <span class="cn">FALSE</span>, nBoot <span class="op">=</span> <span class="fl">100</span>, group.delimiter <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>         trend <span class="op">=</span> <span class="cn">NULL</span>, linkErr <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">dependent</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span>, doCheck <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         engine <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"survey"</span>, <span class="st">"BIFIEsurvey"</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fl">1</span>, rscales <span class="op">=</span> <span class="fl">1</span>, mse<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>         rho<span class="op">=</span><span class="cn">NULL</span>, hetero<span class="op">=</span><span class="cn">TRUE</span>, se_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HC3"</span>, <span class="st">"HC0"</span>, <span class="st">"HC1"</span>, <span class="st">"HC2"</span>, <span class="st">"CR0"</span>, <span class="st">"CR2"</span><span class="op">)</span>,</span>
<span>         clusters <span class="op">=</span> <span class="cn">NULL</span>, crossDiffSE.engine<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lavaan"</span>, <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>         stochasticGroupSizes <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">TRUE</span>, nCores<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-datl">datL<a class="anchor" aria-label="anchor" href="#arg-datl"></a></dt>
<dd><p>Data frame in the long format (i.e. each line represents one ID unit in one imputation of one nest) containing all
variables for analysis.</p></dd>

  <dt id="arg-id">ID<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Variable name or column number of student identifier (ID) variable. ID variable must not contain any missing values.</p></dd>

  <dt id="arg-wgt">wgt<a class="anchor" aria-label="anchor" href="#arg-wgt"></a></dt>
<dd><p>Optional: Variable name or column number of weighting variable. If no weighting variable is specified,
all cases will be equally weighted.</p></dd>

  <dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Defines the replication method for cluster replicates which is to be applied. Depending on <code>type</code>, additional
arguments must be specified (e.g., <code>PSU</code> and/or <code>repInd</code> or <code>repWgt</code>).</p></dd>

  <dt id="arg-psu">PSU<a class="anchor" aria-label="anchor" href="#arg-psu"></a></dt>
<dd><p>Variable name or column number of variable indicating the primary sampling unit (PSU). When a jackknife procedure is applied,
the PSU is the jackknife zone variable. If <code>NULL</code>, no cluster structure is assumed and
standard errors are computed according to a random sample.</p></dd>

  <dt id="arg-repind">repInd<a class="anchor" aria-label="anchor" href="#arg-repind"></a></dt>
<dd><p>Variable name or column number of variable indicating replicate ID. In a jackknife procedure, this is the jackknife replicate
variable. If <code>NULL</code>, no cluster structure is assumed and standard errors are computed according to a random sample.</p></dd>

  <dt id="arg-jkfac">jkfac<a class="anchor" aria-label="anchor" href="#arg-jkfac"></a></dt>
<dd><p>Only applies if <code>engine = "BIFIEsurvey"</code>. Argument is passed to <code><a href="https://rdrr.io/pkg/BIFIEsurvey/man/BIFIE.data.jack.html" class="external-link">BIFIE.data.jack</a></code> and specifies
the factor for multiplying jackknife replicate weights.</p></dd>

  <dt id="arg-repwgt">repWgt<a class="anchor" aria-label="anchor" href="#arg-repwgt"></a></dt>
<dd><p>Normally, replicate weights are created by <code>repMean</code> directly from <code>PSU</code> and <code>repInd</code> variables. Alternatively,
if replicate weights are included in the data.frame, specify the variable names or column number in the <code>repWgt</code> argument.</p></dd>

<dt id="arg-nest">nest<a class="anchor" aria-label="anchor" href="#arg-nest"></a></dt>
<dd><p>Optional: name or column number of the nesting variable. Only applies in nested multiple imputed data sets.</p></dd>

<dt id="arg-imp">imp<a class="anchor" aria-label="anchor" href="#arg-imp"></a></dt>
<dd><p>Optional: name or column number of the imputation variable. Only applies in multiple imputed data sets.</p></dd>

<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>Optional: vector of names or column numbers of one or more grouping variables.</p></dd>

  <dt id="arg-group-splits">group.splits<a class="anchor" aria-label="anchor" href="#arg-group-splits"></a></dt>
<dd><p>Optional: If groups are defined, <code>group.splits</code> optionally specifies whether analysis should be done also
in the whole group or overlying groups. See examples for more details.</p></dd>

  <dt id="arg-group-differences-by">group.differences.by<a class="anchor" aria-label="anchor" href="#arg-group-differences-by"></a></dt>
<dd><p>Optional: Specifies variable group differences should be computed for. The corresponding variable must be included in
the <code>groups</code> statement. Exception: choose 'wholePop' if you want to estimate each's group difference from the
overall sample mean. See examples for further details.</p></dd>

  <dt id="arg-cross-differences">cross.differences<a class="anchor" aria-label="anchor" href="#arg-cross-differences"></a></dt>
<dd><p>Either a list of vectors, specifying the pairs of levels for which cross-level differences should be computed.
Alternatively, if <code>TRUE</code>, cross-level differences for all pairs of levels are computed. If <code>FALSE</code>, no cross-level
differences are computed. (see example 2a, 3, and 4)</p></dd>

  <dt id="arg-crossdiffse">crossDiffSE<a class="anchor" aria-label="anchor" href="#arg-crossdiffse"></a></dt>
<dd><p>Method for standard error estimation for cross level differences, where groups are dependent.
<code>wec</code> uses weighted effect coding, <code>rep</code> uses replication methods (bootstrap or jackknife) to
estimate the standard error between the total mean and group-specific means. <code>old</code> does not account for dependent
groups and treat the groups as if they were independent from each other.</p></dd>

  <dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Variable name or column number of variable(s) for which adjusted means should be computed. Non-numeric variables (factors) will
be converted to 0/1 dichotomous variables.</p></dd>

  <dt id="arg-useeffectliter">useEffectLiteR<a class="anchor" aria-label="anchor" href="#arg-useeffectliter"></a></dt>
<dd><p>Logical: use the <code>lavaan</code>-wrapper <code>EffectLiteR</code> to compute adjusted means? Alternatively, adjusted means
are computed by applying a simple linear regression model in each group, using the variables in <code>adjust</code> as
independent variables. Afterwards, the coefficients are weighted with the (weighted) means of the independent
variables. Standard errors for this procedure are received using the delta method by applying an augmented
variance-covariance matrix which assumes zero covariances between independent variable means and regression
coefficients. We recommend to set <code>useEffectLiteR = TRUE</code> if no replication methods are applied. When
replication methods are used (jackknife-1, jackknife-2, BRR), we recommend to set <code>useEffectLiteR = FALSE</code>,
because otherwise the estimation is very slow.</p></dd>

  <dt id="arg-nboot">nBoot<a class="anchor" aria-label="anchor" href="#arg-nboot"></a></dt>
<dd><p>Without replicates (i.e., for completely random samples), the <code>rep</code> method for standard error estimation for
cross level differences needs a bootstrap. <code>nBoot</code> therefore specifies the number of bootstrap samples.
This argument is only necessary, if <code>crossDiffSE = "rep"</code> <em>and</em> none of the replicate methods
(JK1, JK2, or BRR) is applied. Otherwise, <code>nBoot</code> will be ignored.</p></dd>

  <dt id="arg-group-delimiter">group.delimiter<a class="anchor" aria-label="anchor" href="#arg-group-delimiter"></a></dt>
<dd><p>Character string which separates the group names in the output frame.</p></dd>

  <dt id="arg-trend">trend<a class="anchor" aria-label="anchor" href="#arg-trend"></a></dt>
<dd><p>Optional: name or column number of the trend variable which contains the measurement time of the survey.
Note: Levels of all grouping variables must be equal in all 'sub populations' partitioned by the discrete trend variable.
<code>repMean</code> computes differences for all pairwise contrasts defined by trend variable levels. or three measurement
occasions, i.e. 2010, 2015, and 2020, contrasts (i.e. trends) are computed for 2010 vs. 2015, 2010 vs. 2020, and
2015 vs. 2020.</p></dd>

  <dt id="arg-linkerr">linkErr<a class="anchor" aria-label="anchor" href="#arg-linkerr"></a></dt>
<dd><p>Optional: Either the name or column number of the linking error variable. If <code>NULL</code>, a linking error of 0 will be assumed in trend estimation.
Alternatively, linking errors may be
given as <code>data.frame</code> with following specifications: Two columns, named <code>trendLevel1</code> and <code>trendLevel2</code> which contain the
levels of the trend variable. The contrasts between both values indicates which trend is meant. For only two measurement occasions, i.e.
2010 and 2015, <code>trendLevel1</code> should be <code>2010</code>, and <code>trendLevel2</code> should be <code>2015</code>. For three measurement occasions,
i.e. 2010, 2015, and 2020, additional lines are necessary where <code>trendLevel1</code> should be <code>2010</code>, and <code>trendLevel2</code> should be
<code>2020</code>, to mark the contrast between 2010 and 2020, and further additional lines are necessary where <code>trendLevel1</code> should be
<code>2015</code>, and <code>trendLevel2</code> should be <code>2020</code>. The column <code>depVar</code> must include the name of the dependent variable. This
string must correspond to the name of the dependent variable in the data. The column <code>parameter</code> indicates the parameter the linking
error belongs to. Column <code>linkingError</code> includes the linking error value. Providing linking error in a data.frame is necessary for
more than two measurement occasions. See the example 3a for further details.</p></dd>

  <dt id="arg-dependent">dependent<a class="anchor" aria-label="anchor" href="#arg-dependent"></a></dt>
<dd><p>Variable name or column number of the dependent variable.</p></dd>

  <dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>Logical: Should cases with missing values be dropped?</p></dd>

  <dt id="arg-docheck">doCheck<a class="anchor" aria-label="anchor" href="#arg-docheck"></a></dt>
<dd><p>Logical: Check the data for consistency before analysis? If <code>TRUE</code> groups with insufficient data are excluded from
analysis to prevent subsequent functions from crashing.</p></dd>

  <dt id="arg-engine">engine<a class="anchor" aria-label="anchor" href="#arg-engine"></a></dt>
<dd><p>Which package should be used for estimation?</p></dd>

  <dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>scaling constant for variance, for details, see help page of <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></code> from the <code>survey</code> package</p></dd>

  <dt id="arg-rscales">rscales<a class="anchor" aria-label="anchor" href="#arg-rscales"></a></dt>
<dd><p>scaling constant for variance, for details, see help page of <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></code> from the <code>survey</code> package</p></dd>

  <dt id="arg-mse">mse<a class="anchor" aria-label="anchor" href="#arg-mse"></a></dt>
<dd><p>Logical: If <code>TRUE</code>, compute variances based on sum of squares around the point estimate, rather than the mean of the replicates.
See help page of <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></code> from the <code>survey</code> package for further details.</p></dd>

  <dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>Shrinkage factor for weights in Fay's method. If <code>engine = "survey"</code>, argument is passed to the <code>rho</code> argument of
the <code><a href="https://rdrr.io/pkg/survey/man/svrepdesign.html" class="external-link">svrepdesign</a></code> function from the <code>survey</code> package. See the corresponding help page for further
details. If <code>engine = "BIFIEsurvey"</code>, argument is passed to the <code>fayfac</code> argument of the
<code><a href="https://rdrr.io/pkg/BIFIEsurvey/man/BIFIE.data.jack.html" class="external-link">BIFIE.data.jack</a></code> function from the <code>BIFIEsurvey</code> package. See the
corresponding help page for further details. For convenience, if <code>rho = NULL</code> (the default)
and <code>engine = "BIFIEsurvey"</code> and <code>type = "JK1"</code>, <code><a href="https://rdrr.io/pkg/BIFIEsurvey/man/BIFIE.data.jack.html" class="external-link">BIFIE.data.jack</a></code>
is called with <code>jktype="JK_GROUP"</code> and <code>fayfac = rho</code>, where \(\rho = (N_{cluster} - 1) \times N_{cluster}^{-1}\)</p></dd>

  <dt id="arg-hetero">hetero<a class="anchor" aria-label="anchor" href="#arg-hetero"></a></dt>
<dd><p>Logical: Assume heteroscedastic variance for weighted effect coding?</p></dd>

  <dt id="arg-se-type">se_type<a class="anchor" aria-label="anchor" href="#arg-se-type"></a></dt>
<dd><p>The sort of standard error sought for cross level differences. Only applies if <code>crossDiffSE == "wec"</code> and <code>hetero == TRUE</code>
and <code>crossDiffSE.engine == "lm"</code>. See the help page of <code><a href="https://declaredesign.org/r/estimatr/reference/lm_robust.html" class="external-link">lm_robust</a></code> from the <code>estimatr</code> package for further details.</p></dd>

  <dt id="arg-clusters">clusters<a class="anchor" aria-label="anchor" href="#arg-clusters"></a></dt>
<dd><p>Optional: Variable name or column number of cluster variable. Only necessary if weighted effecting coding
should be performed using heteroscedastic variances. See the help page of <code><a href="https://declaredesign.org/r/estimatr/reference/lm_robust.html" class="external-link">lm_robust</a></code>
from the <code>estimatr</code> package for further details.</p></dd>

  <dt id="arg-crossdiffse-engine">crossDiffSE.engine<a class="anchor" aria-label="anchor" href="#arg-crossdiffse-engine"></a></dt>
<dd><p>Software implementation used for estimating cross-level differences. Choices are either <code>"lavaan"</code> (required if
<code>stochasticGroupSites == "TRUE"</code>) or R function <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>. <code>"lavaan"</code> is the default.</p></dd>

  <dt id="arg-stochasticgroupsizes">stochasticGroupSizes<a class="anchor" aria-label="anchor" href="#arg-stochasticgroupsizes"></a></dt>
<dd><p>Logical: Assume stochastic group sizes for using weighted effect coding in cross-level differences? Note: To date,
only <code>crossDiffSE.engine = "lavaan"</code> allows for stochastic group sizes. Stochastic group sizes are not yet
implemented for any replication method (jackknife, BRR).</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical: Show analysis information on console?</p></dd>

  <dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical: Show progress bar on console?</p></dd>

  <dt id="arg-ncores">nCores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>integer (default: NULL), number of cores to use for parallel processing, if <code>engine = "survey"</code>. If <code>NULL</code>,
single core processing is used.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ -->
Function first creates replicate weights based on PSU and repInd variables (if defined) according to JK2 or BRR procedure
as implemented in WesVar. According to multiple imputed data sets, a workbook with several analyses is created.
The function afterwards serves as a wrapper for <code><a href="https://rdrr.io/pkg/survey/man/surveysummary.html" class="external-link">svymean</a></code> called by <code><a href="https://rdrr.io/pkg/survey/man/svyby.html" class="external-link">svyby</a></code> implemented in
the ‘survey’ package. The results of the several analyses are then pooled according to Rubin's rule.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... -->
A list of data frames in the long format. The output can be summarized using the <code>report</code> function.
The first element of the list is a list with either one (no trend analyses) or two (trend analyses)
data frames with at least six columns each. For each subpopulation denoted by the <code>groups</code>
statement, each parameter (i.e., mean, variance, or group differences) and each coefficient (i.e., the estimate
and the corresponding standard error) the corresponding value is given.</p>
<dl><dt>group</dt>
<dd><p>Denotes the group an analysis belongs to. If no groups were specified and/or analysis for the
whole sample were requested, the value of ‘group’ is ‘wholeGroup’.</p></dd>

<dt>depVar</dt>
<dd><p>Denotes the name of the dependent variable in the analysis.</p></dd>

<dt>modus</dt>
<dd><p>Denotes the mode of the analysis. For example, if a JK2 analysis without sampling weights was
conducted, ‘modus’ takes the value ‘jk2.unweighted’. If a analysis without any replicates but with sampling
weights was conducted, ‘modus’ takes the value ‘weighted’.</p></dd>

<dt>parameter</dt>
<dd><p>Denotes the parameter of the regression model for which the corresponding value is given
further. Amongst others, the ‘parameter’ column takes the values ‘mean’, ‘sd’, ‘var’ and ‘meanGroupDiff’ if
group differences were requested.</p></dd>

<dt>coefficient</dt>
<dd><p>Denotes the coefficient for which the corresponding value is given further. Takes the
values ‘est’ (estimate) and ‘se’ (standard error of the estimate).</p></dd>

<dt>value</dt>
<dd><p>The value of the parameter estimate in the corresponding group.</p></dd>

</dl><p>If groups were specified, further columns which are denoted by the group names are added to the data frame.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>te Grotenhuis, M., Pelzer, B., Eisinga, R., Nieuwenhuis, R., Schmidt-Catran, A., &amp; Konig, R. (2017).
When size matters: advantages of weighted effect coding in observational studies. <em>International Journal of Public Health.</em> <b>62</b>, 163–167.</p>
<p>Sachse, K. A. &amp; Haag, N. (2017). Standard errors for national trends in international
large-scale assessments in the case of cross-national differential item functioning. <em>Applied
Measurement in Education, 30</em>, (2), 102-116. http://dx.doi.org/10.1080/08957347.2017.1283315</p>
<p>Weirich, S., Hecht, M., Becker, B. et al. Comparing group means with the total mean in random samples,
surveys, and large-scale assessments: A tutorial and software illustration. Behav Res (2021).
https://doi.org/10.3758/s13428-021-01553-1</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lsa</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 1: only means, SD and variances for each country</span></span></span>
<span class="r-in"><span><span class="co">### We only consider domain 'reading'</span></span></span>
<span class="r-in"><span><span class="va">rd</span>     <span class="op">&lt;-</span> <span class="va">lsa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">lsa</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### We only consider the first "nest".</span></span></span>
<span class="r-in"><span><span class="va">rdN1</span>   <span class="op">&lt;-</span> <span class="va">rd</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rd</span><span class="op">[</span>,<span class="st">"nest"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### First, we only consider year 2010</span></span></span>
<span class="r-in"><span><span class="va">rdN1y10</span><span class="op">&lt;-</span> <span class="va">rdN1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">rdN1</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2010</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">### mean estimation</span></span></span>
<span class="r-in"><span><span class="va">means1</span> <span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rdN1y10</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type <span class="op">=</span> <span class="st">"JK2"</span>, PSU <span class="op">=</span> <span class="st">"jkzone"</span>,</span></span>
<span class="r-in"><span>          repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>,</span></span>
<span class="r-in"><span>          na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>, engine <span class="op">=</span> <span class="st">"BIFIEsurvey"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 1'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `BIFIEsurvey::BIFIE.data.jack`(data = "datL", wgt = "wgt", jktype = "JK_TIMSS", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     jkzone = "jkzone", jkrep = "jkrep", jkfac = NULL, fayfac = NULL, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cdata = FALSE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MI data with 3 datasets || 92 replication weights with fayfac=1  || 3079 cases and 10 variables </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'BIFIE.univar' for 'call = mean'. dependent = 'score'. group(s) = 'country'. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co">### reporting function: the function does not know which content domain is being considered,</span></span></span>
<span class="r-in"><span><span class="co">### so the user may add new columns in the output using the 'add' argument</span></span></span>
<span class="r-in"><span><span class="va">res1</span>   <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means1</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 1a: Additionally to example 1, we decide to estimate whether</span></span></span>
<span class="r-in"><span><span class="co">### each country's mean differ significantly from the overall mean as well</span></span></span>
<span class="r-in"><span><span class="co">### as from the individual means of the other contries</span></span></span>
<span class="r-in"><span><span class="va">means1a</span><span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rdN1y10</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type <span class="op">=</span> <span class="st">"JK2"</span>, PSU <span class="op">=</span> <span class="st">"jkzone"</span>,</span></span>
<span class="r-in"><span>          repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>          group.differences.by <span class="op">=</span> <span class="st">"country"</span>, cross.differences <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>          dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>, hetero<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 analyse(s) overall according to: 'group.splits = 0 1'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country              country</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute cross level differences using 'wec' method. Assume homoscedastic variances.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res1a</span>  <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means1a</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### See that the means of all countries significantly differ from the overall mean.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res1a</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">res1a</span><span class="op">[</span>,<span class="st">"comparison"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"crossDiff"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">res1a</span><span class="op">[</span>,<span class="st">"parameter"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"mean"</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    parameter            modus depVar comparison                         group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       mean JK2.mean__survey  score  crossDiff crossDiff (countryA - total) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      mean JK2.mean__survey  score  crossDiff crossDiff (countryB - total) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17      mean JK2.mean__survey  score  crossDiff crossDiff (countryC - total) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     domain                country     es   est     p   se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  reading countryA.vs.wholeGroup -0.139 -11.1 0.000 2.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 reading countryB.vs.wholeGroup -0.169 -14.1 0.001 4.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 reading countryC.vs.wholeGroup  0.141  11.6 0.000 2.07</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2: Sex differences by country. Assume equally weighted cases by omitting</span></span></span>
<span class="r-in"><span><span class="co">### 'wgt' argument.</span></span></span>
<span class="r-in"><span><span class="va">means2</span> <span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rdN1y10</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, type <span class="op">=</span> <span class="st">"JK2"</span>, PSU <span class="op">=</span> <span class="st">"jkzone"</span>,</span></span>
<span class="r-in"><span>          repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>          group.differences.by<span class="op">=</span><span class="st">"sex"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>          cross.differences <span class="op">=</span><span class="cn">TRUE</span>, crossDiffSE.engine<span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute cross level differences using 'wec' method. Assume heteroscedastic variances.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 32 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 60 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 40 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 91 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res2</span>   <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means2</span>,add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2a: Additionally to example 2, we decide to estimate whether</span></span></span>
<span class="r-in"><span><span class="co">### each country's mean differ significantly from the overall mean. (Note: by default,</span></span></span>
<span class="r-in"><span><span class="co">### such cross level differences are estimated using 'weighted effect coding'. Use the</span></span></span>
<span class="r-in"><span><span class="co">### 'crossDiffSE' argument to choose alternative methods.) Moreover, we estimate whether</span></span></span>
<span class="r-in"><span><span class="co">### each country's sex difference differ significantly from the sex difference in the</span></span></span>
<span class="r-in"><span><span class="co">### whole population.</span></span></span>
<span class="r-in"><span><span class="va">means2a</span><span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rdN1y10</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type <span class="op">=</span> <span class="st">"JK2"</span>, PSU <span class="op">=</span> <span class="st">"jkzone"</span>,</span></span>
<span class="r-in"><span>          repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>          group.differences.by<span class="op">=</span><span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>          crossDiffSE.engine<span class="op">=</span> <span class="st">"lm"</span>, clusters <span class="op">=</span> <span class="st">"idclass"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res2a</span>  <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means2a</span>,add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Third example: like example 2a, but using nested imputations of dependent variable,</span></span></span>
<span class="r-in"><span><span class="co">### and additionally estimating trend: use 'rd' instead of 'rdN1y10'</span></span></span>
<span class="r-in"><span><span class="co">### assume equally weighted cases by omitting 'wgt' argument</span></span></span>
<span class="r-in"><span><span class="co">### ignoring jackknife by omitting 'type', 'PSU' and 'repInd' argument</span></span></span>
<span class="r-in"><span><span class="va">means3T</span><span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rd</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, nest<span class="op">=</span><span class="st">"nest"</span>,</span></span>
<span class="r-in"><span>          groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, group.differences.by<span class="op">=</span><span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>          cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>          doCheck<span class="op">=</span><span class="cn">TRUE</span>, trend <span class="op">=</span> <span class="st">"year"</span>, linkErr <span class="op">=</span> <span class="st">"leScore"</span>,</span></span>
<span class="r-in"><span>          crossDiffSE <span class="op">=</span> <span class="st">"wec"</span>, crossDiffSE.engine<span class="op">=</span> <span class="st">"lavaan"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-in"><span><span class="va">res3T</span>  <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means3T</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 3a: like example 3, but providing linking errors in an additional data.frame</span></span></span>
<span class="r-in"><span><span class="co">### This is optional for two measurement occasions but mandatory if the analysis contains</span></span></span>
<span class="r-in"><span><span class="co">### more than two measurement occasions</span></span></span>
<span class="r-in"><span><span class="va">linkErr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span> trendLevel1 <span class="op">=</span> <span class="fl">2010</span>, trendLevel2 <span class="op">=</span> <span class="fl">2015</span>,  depVar <span class="op">=</span> <span class="st">"score"</span>,</span></span>
<span class="r-in"><span>          parameter <span class="op">=</span> <span class="st">"mean"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">lsa</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"domain"</span>, <span class="st">"leScore"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">linkErr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">linkErr</span><span class="op">)</span>, <span class="st">"'leScore'='linkingError'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### note that the linking errors for the specified domain have to be chosen via</span></span></span>
<span class="r-in"><span><span class="co">### subsetting</span></span></span>
<span class="r-in"><span><span class="va">means3a</span><span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rd</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, nest<span class="op">=</span><span class="st">"nest"</span>,</span></span>
<span class="r-in"><span>          groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, group.differences.by<span class="op">=</span><span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>          cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>, trend <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>          linkErr <span class="op">=</span> <span class="va">linkErr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">linkErr</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span>,</span></span>
<span class="r-in"><span>          crossDiffSE <span class="op">=</span> <span class="st">"wec"</span>, crossDiffSE.engine<span class="op">=</span> <span class="st">"lavaan"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    'wec' method: Assume equally weighted cases.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-in"><span><span class="va">res3a</span>  <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means3a</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No linking errors for parameters 'Ncases', 'NcasesValid', 'sd', 'var'. Linking errors for these parameters will be defaulted to 0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Found 23 missing linking errors for dependent variable 'score' and parameter(s) 'sd'. Assume linking error of 0 for these cases.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Fourth example: using a loop do analyse 'reading' and 'listening' comprehension</span></span></span>
<span class="r-in"><span><span class="co">### in one function call. Again with group and cross differences and trends, and</span></span></span>
<span class="r-in"><span><span class="co">### trend differences</span></span></span>
<span class="r-in"><span><span class="co">### we use weights but omit jackknife analysis by omitting 'type', 'PSU' and 'repInd'</span></span></span>
<span class="r-in"><span><span class="co">### argument</span></span></span>
<span class="r-in"><span><span class="va">means4T</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span> <span class="op">(</span> data <span class="op">=</span> <span class="va">lsa</span>, INDICES <span class="op">=</span> <span class="va">lsa</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sub.dat</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">sub.dat</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, nest<span class="op">=</span><span class="st">"nest"</span>,</span></span>
<span class="r-in"><span>                 groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                 group.differences.by<span class="op">=</span><span class="st">"sex"</span>,</span></span>
<span class="r-in"><span>                 cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="st">"score"</span>,</span></span>
<span class="r-in"><span>                 na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 trend <span class="op">=</span> <span class="st">"year"</span>, linkErr <span class="op">=</span> <span class="st">"leScore"</span>, crossDiffSE.engine<span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  analysis.number hierarchy.level groups.divided.by group.differences.by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                1               0                                   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                2               1           country                 &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                3               1               sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                4               2     country + sex                  sex</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 0'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume nested structure with 2 nests and 3 imputations in each nest. This will result in 2 x 3 = 6 imputation replicates.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: No linking error was defined. Linking error will be defaulted to '0'.</span>
<span class="r-in"><span><span class="va">ret4T</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">means4T</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">domain</span> <span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>          <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means4T</span><span class="op">[[</span><span class="va">domain</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="va">domain</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span><span class="co">### Fifth example: compute adjusted means, also with trend estimation</span></span></span>
<span class="r-in"><span><span class="co">### Note: all covariates must be numeric or 0/1 dichotomous</span></span></span>
<span class="r-in"><span><span class="va">rdN1</span><span class="op">[</span>,<span class="st">"mignum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">rdN1</span><span class="op">[</span>,<span class="st">"mig"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rdN1</span><span class="op">[</span>,<span class="st">"sexnum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">rdN1</span><span class="op">[</span>,<span class="st">"sex"</span><span class="op">]</span>, <span class="st">"'male'=0; 'female'=1"</span>, as.numeric<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                   as.factor<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">means5</span> <span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span>datL <span class="op">=</span> <span class="va">rdN1</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type <span class="op">=</span> <span class="st">"JK2"</span>, PSU <span class="op">=</span> <span class="st">"jkzone"</span>,</span></span>
<span class="r-in"><span>          repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>,</span></span>
<span class="r-in"><span>          adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sexnum"</span>, <span class="st">"ses"</span>, <span class="st">"mignum"</span><span class="op">)</span>, useEffectLiteR <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>          dependent <span class="op">=</span> <span class="st">"score"</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, doCheck<span class="op">=</span><span class="cn">TRUE</span>, trend <span class="op">=</span> <span class="st">"year"</span>,</span></span>
<span class="r-in"><span>          linkErr <span class="op">=</span> <span class="st">"leScore"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2010'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 1'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 92 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Trend group: '2015'</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 analyse(s) overall according to: 'group.splits = 1'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assume unnested structure with 3 imputations.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Create 73 replicate weights according to JK2 procedure.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">res5</span>   <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means5</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cannot find standard deviations in output. Skip computation of effect sizes.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">############################################################################################</span></span></span>
<span class="r-in"><span><span class="co">#    Example 6: R code for running the PISA 2015 science example to compare group means    #</span></span></span>
<span class="r-in"><span><span class="co">#                    with the total mean using weighted effect coding                      #</span></span></span>
<span class="r-in"><span><span class="co">############################################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Warning: large PISA data set requires at least 16 GB free working memory (RAM):</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### define necessary directories (note: writing permissions required)</span></span></span>
<span class="r-in"><span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### download PISA 2015 zipped student questionnaire data (420 MB) to a folder with</span></span></span>
<span class="r-in"><span><span class="co">### writing permissions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://webfs.oecd.org/pisa/PUF_SPSS_COMBINED_CMB_STU_QQQ.zip"</span>,</span></span>
<span class="r-in"><span>         destfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"pisa2015.zip"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### unzip PISA 2015 student questionnaire data (1.5 GB) to temporary folder</span></span></span>
<span class="r-in"><span><span class="fu">zip</span><span class="fu">::</span><span class="fu">unzip</span><span class="op">(</span>zipfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">folder</span>, <span class="st">"pisa2015.zip"</span><span class="op">)</span>, files<span class="op">=</span> <span class="st">"CY6_MS_CMB_STU_QQQ.sav"</span>,</span></span>
<span class="r-in"><span>     exdir<span class="op">=</span><span class="va">folder</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### read data</span></span></span>
<span class="r-in"><span><span class="va">pisa</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html" class="external-link">read.spss</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span> <span class="op">(</span><span class="va">folder</span>, <span class="st">"CY6_MS_CMB_STU_QQQ.sav"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        to.data.frame<span class="op">=</span><span class="cn">TRUE</span>, use.value.labels <span class="op">=</span> <span class="cn">FALSE</span>, use.missings <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dependent variables</span></span></span>
<span class="r-in"><span><span class="va">measure.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"PV"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="st">"SCIE"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### choose desired variables and reshape into the long format</span></span></span>
<span class="r-in"><span><span class="co">#              'CNTSTUID' = individual student identifier</span></span></span>
<span class="r-in"><span><span class="co">#                   'CNT' = country identifier</span></span></span>
<span class="r-in"><span><span class="co">#                 'SENWT' = senate weight (assume a population of 5000 in each country)</span></span></span>
<span class="r-in"><span><span class="co">#              'W_FSTUWT' = final student weight</span></span></span>
<span class="r-in"><span><span class="co">#                  'OECD' = dummy variable indicating which country is part of the OECD</span></span></span>
<span class="r-in"><span><span class="co">#   'W_FSTURWT' (1 to 80) = balanced repeated replicate weights</span></span></span>
<span class="r-in"><span><span class="co"># 'PV1SCIE' to 'PV10SCIE' = 10 plausible values of (latent) science performance</span></span></span>
<span class="r-in"><span><span class="va">pisaLong</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">pisa</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CNTSTUID"</span>, <span class="st">"CNT"</span>, <span class="st">"SENWT"</span>, <span class="st">"W_FSTUWT"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"OECD"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"W_FSTURWT"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            measure.vars <span class="op">=</span> <span class="va">measure.vars</span>, value.name <span class="op">=</span> <span class="st">"value"</span>, variable.name<span class="op">=</span><span class="st">"imp"</span>,</span></span>
<span class="r-in"><span>            na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### choose OECD countries</span></span></span>
<span class="r-in"><span><span class="va">oecd</span> <span class="op">&lt;-</span> <span class="va">pisaLong</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pisaLong</span><span class="op">[</span>,<span class="st">"OECD"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### analyze data</span></span></span>
<span class="r-in"><span><span class="co">### analysis takes approximately 30 minutes on an Intel i5-6500 machine with 32 GB RAM</span></span></span>
<span class="r-in"><span><span class="va">means</span>   <span class="op">&lt;-</span> <span class="fu">repMean</span><span class="op">(</span> datL <span class="op">=</span> <span class="va">oecd</span>,         <span class="co"># data.frame in the long format</span></span></span>
<span class="r-in"><span>    ID                   <span class="op">=</span> <span class="st">"CNTSTUID"</span>,   <span class="co"># student identifier</span></span></span>
<span class="r-in"><span>    dependent            <span class="op">=</span> <span class="st">"value"</span>,      <span class="co"># the dependent variable in the data</span></span></span>
<span class="r-in"><span>    groups               <span class="op">=</span> <span class="st">"CNT"</span>,        <span class="co"># the grouping variable</span></span></span>
<span class="r-in"><span>    wgt                  <span class="op">=</span> <span class="st">"SENWT"</span>,      <span class="co"># (optional) weighting variable. We use senate</span></span></span>
<span class="r-in"><span>                                         <span class="co"># weights (assume a population of 5000 in each</span></span></span>
<span class="r-in"><span>                                         <span class="co"># country)</span></span></span>
<span class="r-in"><span>    type                 <span class="op">=</span> <span class="st">"Fay"</span>,        <span class="co"># type of replication method. Corresponding to</span></span></span>
<span class="r-in"><span>                                         <span class="co"># the PISA sampling method, we use "Fay"</span></span></span>
<span class="r-in"><span>    rho                  <span class="op">=</span> <span class="fl">0.5</span>,          <span class="co"># shrinkage factor for weights in Fay's method</span></span></span>
<span class="r-in"><span>    scale                <span class="op">=</span> <span class="cn">NULL</span>,         <span class="co"># scaling constant for variance, set to NULL</span></span></span>
<span class="r-in"><span>                                         <span class="co"># according to PISA's sampling method</span></span></span>
<span class="r-in"><span>    rscales              <span class="op">=</span> <span class="cn">NULL</span>,         <span class="co"># scaling constant for variance, set to NULL</span></span></span>
<span class="r-in"><span>                                         <span class="co"># according to PISA's sampling method</span></span></span>
<span class="r-in"><span>    repWgt               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"W_FSTURWT"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span>, <span class="co"># the replicate weights,</span></span></span>
<span class="r-in"><span>                                                      <span class="co"># provided by the OECD</span></span></span>
<span class="r-in"><span>    imp                  <span class="op">=</span> <span class="st">"imp"</span>,        <span class="co"># the imputation variable</span></span></span>
<span class="r-in"><span>    mse                  <span class="op">=</span> <span class="cn">FALSE</span>,        <span class="co"># if TRUE, compute variances based on sum of</span></span></span>
<span class="r-in"><span>                                         <span class="co"># squares around the point estimate, rather</span></span></span>
<span class="r-in"><span>                                         <span class="co"># than the mean of the replicates.</span></span></span>
<span class="r-in"><span>    group.splits         <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,          <span class="co"># defining the 'levels' for which means should</span></span></span>
<span class="r-in"><span>                                         <span class="co"># be computed. 0:1 implies that means for the</span></span></span>
<span class="r-in"><span>                                         <span class="co"># whole sample (level 0) as well as for groups</span></span></span>
<span class="r-in"><span>                                         <span class="co"># (level 1) are computed</span></span></span>
<span class="r-in"><span>    cross.differences    <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># defines whether (and which) cross level mean</span></span></span>
<span class="r-in"><span>                                         <span class="co"># differences should be computed. TRUE means</span></span></span>
<span class="r-in"><span>                                         <span class="co"># that all cross level mean differences are</span></span></span>
<span class="r-in"><span>                                         <span class="co"># computed</span></span></span>
<span class="r-in"><span>    crossDiffSE          <span class="op">=</span> <span class="st">"wec"</span>,        <span class="co"># method for standard errors of mean</span></span></span>
<span class="r-in"><span>                                         <span class="co"># differences</span></span></span>
<span class="r-in"><span>    crossDiffSE.engine   <span class="op">=</span> <span class="st">"lm"</span>,         <span class="co"># software implementation for standard</span></span></span>
<span class="r-in"><span>                                         <span class="co"># errors of mean differences</span></span></span>
<span class="r-in"><span>    hetero               <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># assume heteroscedastic group variances</span></span></span>
<span class="r-in"><span>    stochasticGroupSizes <span class="op">=</span> <span class="cn">FALSE</span>         <span class="co"># assume fixed group sizes</span></span></span>
<span class="r-in"><span>                   <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### call a reporting function to generate user-friendly output</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="report.html">report</a></span><span class="op">(</span><span class="va">means</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ncases"</span>, <span class="st">"NcasesValid"</span>, <span class="st">"var"</span>, <span class="st">"sd"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }# }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Sebastian Weirich, Martin Hecht, Karoline Sachse, Benjamin Becker.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

