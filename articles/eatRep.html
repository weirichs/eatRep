<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Replication analyses with eatRep • eatRep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Replication analyses with eatRep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eatRep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.15.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/eatRep.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/weirichs/eatRep/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Replication analyses with eatRep</h1>
                        <h4 data-toc-skip class="author">Sebastian
Weirich and Benjamin Becker</h4>
            
            <h4 data-toc-skip class="date">Apr 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/weirichs/eatRep/blob/master/vignettes/eatRep.rmd" class="external-link"><code>vignettes/eatRep.rmd</code></a></small>
      <div class="hidden name"><code>eatRep.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The following vignette demonstrates some analyses based on
replication methods <span class="citation">(Krewski &amp; Rao, 1981;
Rust, 2014; Rust &amp; Rao, 1996; Wolter, 2007)</span>. Replication
methods are quite common in the context of survey or large-scale
assessment data <span class="citation">(Foy et al., 2008)</span> like
the <a href="https://www.iqb.hu-berlin.de/bt" class="external-link">“National Assessment
Studies and IQB Trends in Student Achievement”</a> . The following
examples are closely related to the “IQB” context (e.g., jackknife-2
methods are used instead of balanced repeated replicates), but may be
adapted for PISA or TIMSS analyses as well. For an illustration how
<code>eatRep</code> can be applied to PISA data and its specific
replication design, see the last example in the documentation of the
<code><a href="../reference/repMean.html">repMean()</a></code> function.</p>
<p>Please note that the theoretical foundations of the presented methods
are beyond the scope of this vignette—literature recommendations for in
depth theoretical discussions can be found in the package documentation
(type <code><a href="../reference/eatRep-package.html">package?eatRep</a></code> into the console). Instead, this
vignette focuses on some prototypical analyses.</p>
<p>Furthermore, note that IRT item calibration <span class="citation">(Hambleton et al., 1991; Hambleton &amp; Jones, 1993;
Mislevy, Johnson, et al., 1992)</span> or “plausible values” imputation
<span class="citation">(Davier et al., 2009; Mislevy, Beaton, et al.,
1992; Monseur &amp; Adams, 2009)</span> are not covered in this
vignette. All the outlined analyses base on survey data in which
“plausible values” are already included. Such kind of data is provided
by the <a href="https://www.oecd.org/en/data/datasets/pisa-2022-database.html" class="external-link">OECD</a>
or can be requested from the <a href="https://www.iqb.hu-berlin.de/fdz" class="external-link">“Research Data Centre (FDZ) at
the IQB”</a>. Most of the analyses comprise of descriptive statistics
(means, standard deviations), frequency distributions, and linear or
logistic regression models. Usually, sampling designs for large-scale
assessments have the following, specific characteristics:</p>
<ol style="list-style-type: decimal">
<li><p>Often, individuals in survey data are not randomly drawn from the
population. In educational assessments which aim to compare countries,
for example, the proportions in the sample do not necessarily correspond
to the proportions in the population. Often, institutions like the OECD
provide sampling weights according with their data which allow to
estimate population parameters.</p></li>
<li><p>The (primary) sampling units in educational data are classes
instead of individuals. Hence, the sample is clustered. Students within
a class are more alike than students from different classes. Therefore,
clustered sampled students are more homogeneous than randomly sampled
students which may lead to biased standard error estimates in
inference-based analyses.</p></li>
<li><p>Variables of interest (e.g. educational achievement) are latent
and not directly observable (they are inherently missing). Additionally,
questionnaire data frequently include missing responses. Therefore,
institutions like the OECD or the IQB provide imputed data.</p></li>
</ol>
<p><code>eatRep</code> allows to compute (adjusted) means and mean
differences, frequency tables, percentiles, and parameter of (log)
linear regression models, taking the clustered and/or imputed sample
into account via replication methods. Trend analyses are possible as
well. <code>eatRep</code> meets the special features mentioned above (if
they apply) in the following way:</p>
<p>1.: include sampling weights for the analyses.</p>
<p>2.: Use replication methods (Bootstrap, jackknife or “Balanced
repeated replicates”) for inference statistics.</p>
<p>3.: Pool the results by applying specific rules <span class="citation">(Little &amp; Rubin, 1987; Rubin, 2003)</span>.</p>
<p>However, <code>eatRep</code> is also suitable if the data is
clustered without imputations or imputed without clustered sampling. The
three mentioned methods (using weights, replication methods, pooling
methods) can be called independently from each other.</p>
</div>
<div class="section level2">
<h2 id="installation">0. Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>We recommend to use R version 4.0.0 or higher. <code>eatRep</code> is
available from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"eatRep"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-data">1. Example data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h2>
<p><code>eatRep</code> contains exemplary data named <code>lsa</code>
(“large scale assessment”), which resembles the “IQB
Gesamtanalysedatensatz (GADS)”. <code>lsa</code>, however, is reduced in
numbers of examinees, imputations, and variables. Once the package is
loaded, the structure of <code>lsa</code> can be inspected via:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/weirichs/eatRep" class="external-link">eatRep</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lsa</span>, package<span class="op">=</span><span class="st">"eatRep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">lsa</span>, give.attr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    77322 obs. of  25 variables:</span></span>
<span><span class="co">##  $ year     : num  2010 2010 2010 2010 2010 2010 2010 2010 2010 2010 ...</span></span>
<span><span class="co">##  $ idstud   : Factor w/ 11655 levels "P00001","P00002",..: 1 1 1 1 1 1 2 2 2 2 ...</span></span>
<span><span class="co">##  $ idclass  : Factor w/ 432 levels "C001","C002",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ wgt      : num  2.6 2.6 2.6 2.6 2.6 ...</span></span>
<span><span class="co">##  $ L2wgt    : num  2.43 2.43 2.43 2.43 2.43 ...</span></span>
<span><span class="co">##  $ L1wgt    : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ jkzone   : num  22 22 22 22 22 22 22 22 22 22 ...</span></span>
<span><span class="co">##  $ jkrep    : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ imp      : num  3 2 1 1 2 3 2 3 2 1 ...</span></span>
<span><span class="co">##  $ nest     : num  1 2 2 1 1 2 2 2 1 2 ...</span></span>
<span><span class="co">##  $ country  : Factor w/ 3 levels "countryA","countryB",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ sex      : Factor w/ 2 levels "female","male": 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ ses      : num  56 56 56 56 56 56 32.5 32.5 32.5 32.5 ...</span></span>
<span><span class="co">##  $ mig      : logi  TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">##  $ domain   : Factor w/ 2 levels "listening","reading": 1 1 1 1 1 1 2 2 2 2 ...</span></span>
<span><span class="co">##  $ score    : num  366 366 425 551 485 ...</span></span>
<span><span class="co">##  $ comp     : num  1 1 2 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">##  $ failMin  : num  1 1 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ passReg  : num  0 0 0 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ passOpt  : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ leScore  : num  1.22 1.22 1.22 1.22 1.22 ...</span></span>
<span><span class="co">##  $ leComp   : num  0.00262 0.00262 0.0022 0.00155 0.00155 ...</span></span>
<span><span class="co">##  $ leFailMin: num  0.00262 0.00262 0.00262 0.00262 0.00262 ...</span></span>
<span><span class="co">##  $ lePassReg: num  0.00482 0.00482 0.00482 0.00482 0.00482 ...</span></span>
<span><span class="co">##  $ lePassOpt: num  0.00059 0.00059 0.00059 0.00059 0.00059 ...</span></span></code></pre>
<p><code>lsa</code> is in the long format; this means the data set
contains multiple rows per individual person. Imputed variables (e.g.,
migration background, <code>mig</code>) <em>do not</em> occur in several
columns (<code>mig_Imp_1</code>, <code>mig_Imp_2</code>,
<code>mig_Imp_3</code>, and so on), but only once: <code>mig</code>.
Multiple imputations are stored in multiple rows, and the variable
<code>imp</code> yields the number of the imputed data set. Furthermore,
variables which refer to different competence domains (reading,
listening) <em>and</em> different imputations <em>and</em> different
times of measurement (i.e., the competence variable <code>score</code>)
do not occur in multiple columns (<code>reading_2010_score_Imp_1</code>,
<code>reading_2010_score_Imp_2</code>, …,
<code>listening_2010_score_Imp_1</code>,
<code>listening_2015_score_Imp_1</code>, …). <code>score</code> only
occurs once, and <code>imp</code> defines the imputation, whereas
<code>domain</code> gives the competence domain. To reshape data between
the long and wide format, see for example the package <code>tidyr</code>
(<code>pivot_wider()</code>, <code>pivot_longer()</code>) or the
function <code><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong()</a></code> from the package
<code>eatTools</code>. See section 1.1 for more details about reshaping
and examples.</p>
<p><code>lsa</code> contains the following variables:</p>
<ul>
<li>
<code>year</code>: year of assessment (2010 or 2015)</li>
<li>
<code>idstud</code>: individual student identifier; the data set
contains 11,637 persons overall</li>
<li>
<code>idclass</code>: class identifier; the data set contains 432
classes overall</li>
<li>
<code>wgt</code>: sampling weight</li>
<li>
<code>jkzone</code>: jackknife zone</li>
<li>
<code>jkrep</code>: jackknife replicate</li>
<li>
<code>imp</code>: number of imputation (1, 2, or 3)</li>
<li>
<code>nest</code>: number of nest (for nested imputation which is
not yet considered here, but see the examples of <code><a href="../reference/repMean.html">repMean()</a></code>
for further details)</li>
<li>
<code>country</code>: federal state the student stems from</li>
<li>
<code>sex</code>: students sex (male, female)</li>
<li>
<code>ses</code>: socio economical status</li>
<li>
<code>mig</code>: migration background</li>
<li>
<code>domain</code>: competence domain (listening or reading)</li>
<li>
<code>score</code>: point estimate (e.g., plausible value) for the
corresponding imputation and domain. According to PISA, the scale is
normed with a mean of 500 and a standard deviation of 100</li>
<li>
<code>comp</code>: competence level with 5 distinct levels according
to pre-defined cut scores. “1” corresponds to the lowest competence
level, and “5” corresponds to the highest competence level</li>
<li>
<code>failMin</code>: does the student fail to achieve the minimum
standard?</li>
<li>
<code>passReg</code>: does the student achieve regular
standard?</li>
<li>
<code>passOpt</code>: does the student achieve optimal
standard?</li>
<li>
<code>leScore</code>: linking error according to <code>score</code>
variable</li>
<li>
<code>leComp</code>: linking error according to <code>comp</code>
variable</li>
<li>
<code>leFailMin</code>: linking error according to
<code>failMin</code> variable</li>
<li>
<code>lePassReg</code>: linking error according to
<code>passReg</code> variable</li>
<li>
<code>lePassOpt</code>: linking error according to
<code>passOpt</code> variable</li>
</ul>
<p><code>lsa</code> includes more than 77,000 observations. Actual large
scale assessment data, however, have much more observations.
<code>lsa</code> only represents a small section with only 3 imputations
(instead of 10 used in PISA), 3 federal states (PISA includes 35 OECD
countries), and two domains. Most variables have labels, stored as
attributes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">lsa</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $varLabel</span></span>
<span><span class="co">## [1] "year of assessment (2010 or 2015)"</span></span></code></pre>
<p>As nested imputations are not considered here, we reduce the data to
the first nest:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt</span> <span class="op">&lt;-</span> <span class="va">lsa</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">lsa</span><span class="op">[</span>,<span class="st">"nest"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="excursus-reshape-imputed-data-from-wide-into-long-format">1.1 Excursus: reshape imputed data from wide into long format<a class="anchor" aria-label="anchor" href="#excursus-reshape-imputed-data-from-wide-into-long-format"></a>
</h3>
<p>Institutions like PISA provide imputed data in the wide format. Each
row in the data matrix represents one person. <code>eatRep</code>,
however, needs the long format. (Without imputations, this procedure is
not necessary.) Wide format data stores different imputations of the
same variable in different columns. The number of imputations is not
stored in an explicit variable but results from the number of additional
columns per variable. Long format data stores different imputations of
the same variable in additional rows. A variable like <code>imp</code>
defines the number of the imputation.</p>
<p><code>reshape2</code>, <code>tidyr</code> or <code>data.table</code>
provide functions for reshaping. Moreover, <code>eatTools</code>
provides the <code><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong()</a></code> function for easy reshaping into
the required long format. We illustrate the functionality with the help
of the wide format exemplary data <code>data.timss3</code> from the
<code>BIFIEsurvey</code> package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.timss3</span>, package<span class="op">=</span><span class="st">"BIFIEsurvey"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data.timss3</span>, give.attr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'data.frame':    4668 obs. of  20 variables:</span></span>
<span><span class="co">##  $ IDSTUD : num  4e+08 4e+08 4e+08 4e+08 4e+08 ...</span></span>
<span><span class="co">##  $ TOTWGT : num  17.5 17.5 17.5 17.5 17.5 ...</span></span>
<span><span class="co">##  $ JKZONE : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ JKREP  : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ female : num  1 0 1 1 1 1 1 1 0 0 ...</span></span>
<span><span class="co">##  $ books  : num  3 3 5 3 3 2 4 3 3 4 ...</span></span>
<span><span class="co">##  $ lang   : num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ migrant: num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ scsci  : num  NA 2 2 1 2 3 2 2 1 1 ...</span></span>
<span><span class="co">##  $ likesc : num  2 4 2 1 1 1 2 2 NA 1 ...</span></span>
<span><span class="co">##  $ ASMMAT1: num  543 522 456 512 506 ...</span></span>
<span><span class="co">##  $ ASSSCI1: num  600 512 497 584 533 ...</span></span>
<span><span class="co">##  $ ASMMAT2: num  557 533 462 510 563 ...</span></span>
<span><span class="co">##  $ ASSSCI2: num  578 519 545 614 568 ...</span></span>
<span><span class="co">##  $ ASMMAT3: num  506 557 445 531 530 ...</span></span>
<span><span class="co">##  $ ASSSCI3: num  570 554 528 569 564 ...</span></span>
<span><span class="co">##  $ ASMMAT4: num  524 511 473 497 488 ...</span></span>
<span><span class="co">##  $ ASSSCI4: num  560 506 550 597 483 ...</span></span>
<span><span class="co">##  $ ASMMAT5: num  578 546 457 528 583 ...</span></span>
<span><span class="co">##  $ ASSSCI5: num  607 565 546 623 578 ...</span></span></code></pre>
<p>Data contains 4668 rows according to 4668 persons. The following
variables should be considered for reshaping:</p>
<ul>
<li>
<code>IDSTUD</code>: individual student identifier</li>
<li>
<code>TOTWGT</code>: weighting variable</li>
<li>
<code>JKZONE</code>: jackknife zone</li>
<li>
<code>JKREP</code>: jackknife replicate</li>
<li>
<code>female</code>: students sex (1 = female; 0 = male)</li>
<li>
<code>books</code>: number of books at home</li>
<li>
<code>lang</code>: language at home (How often is the language used
in the test spoken at home?)</li>
<li>
<code>migrant</code>: migration background</li>
<li>
<code>ASMMAT1</code>: first imputation (first plausible value) for
math competence</li>
<li>
<code>ASMMAT2</code>: second imputation (second plausible value) for
math competence</li>
<li>
<code>ASMMAT3</code>: third imputation (third plausible value) for
math competence</li>
<li>
<code>ASMMAT4</code>: fourth imputation (fourth plausible value) for
math competence</li>
<li>
<code>ASMMAT5</code>: fifth imputation (fifth plausible value) for
math competence</li>
<li>
<code>ASSSCI1</code>: first imputation (first plausible value) for
science competence</li>
<li>
<code>ASSSCI2</code>: second imputation (second plausible value) for
science competence</li>
<li>
<code>ASSSCI3</code>: third imputation (third plausible value) for
science competence</li>
<li>
<code>ASSSCI4</code>: fourth imputation (fourth plausible value) for
science competence</li>
<li>
<code>ASSSCI5</code>: fifth imputation (fifth plausible value) for
science competence</li>
</ul>
<p>As TIMSS data is in the wide format, no imputation variable exists.
In contrast to the long format, we can easily see which variables are
imputed (<code>ASMMAT</code> occurs five times), and which are not
(<code>female</code> only occurs once). For reshaping, number of
imputations must be constant across imputed variables—hence,
<code><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong()</a></code> cannot be used for nested imputed data.
<code><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong()</a></code> needs to know all variables which should be
used for further analyses—the remaining variables can be ignored. The
functionality differentiates between imputed and non-imputed
variables:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/weirichs/eatTools" class="external-link">eatTools</a></span><span class="op">)</span></span>
<span><span class="va">timssLong</span> <span class="op">&lt;-</span> <span class="fu">eatTools</span><span class="fu">::</span><span class="fu"><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong</a></span><span class="op">(</span>datWide <span class="op">=</span> <span class="va">data.timss3</span>, </span>
<span>             noImp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IDSTUD"</span>, <span class="st">"TOTWGT"</span>, <span class="st">"JKZONE"</span>, <span class="st">"JKREP"</span>, <span class="st">"female"</span><span class="op">)</span>, </span>
<span>             imp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span> math <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASMMAT1"</span>, <span class="st">"ASMMAT2"</span>, <span class="st">"ASMMAT3"</span>, <span class="st">"ASMMAT4"</span>, <span class="st">"ASMMAT5"</span><span class="op">)</span>, </span>
<span>                       science <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ASSSCI1"</span>, <span class="st">"ASSSCI2"</span>, <span class="st">"ASSSCI3"</span>, <span class="st">"ASSSCI4"</span>, <span class="st">"ASSSCI5"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The non-imputed variables can be defined in a single character
string, whereas imputed variables should be defined in a named list with
one or more character strings. In our example, variable
<code>math</code> consists of five imputations <code>ASMMAT1</code>,
<code>ASMMAT2</code>, <code>ASMMAT3</code>, <code>ASMMAT4</code>, and
<code>ASMMAT5</code>. Variable <code>science</code> also consists of
five imputations, <code>ASSSCI1</code>, <code>ASSSCI2</code>,
<code>ASSSCI3</code>, <code>ASSSCI4</code>, and <code>ASSSCI5</code>.
Resulting data <code>timssLong</code> now is suitable for
<code>eatRep</code> analyses. For many imputations (e.g., 15),
specifying character strings is more straightforward by using the
<code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste()</a></code> or <code><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0()</a></code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timssLong</span> <span class="op">&lt;-</span> <span class="fu">eatTools</span><span class="fu">::</span><span class="fu"><a href="https://weirichs.github.io/eatTools/reference/wideToLong.html" class="external-link">wideToLong</a></span><span class="op">(</span>datWide <span class="op">=</span> <span class="va">data.timss3</span>, </span>
<span>             noImp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IDSTUD"</span>, <span class="st">"TOTWGT"</span>, <span class="st">"JKZONE"</span>, <span class="st">"JKREP"</span>, <span class="st">"female"</span><span class="op">)</span>, </span>
<span>             imp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span> math <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ASMMAT"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,  </span>
<span>                       science <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ASSSCI"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Alternatively, reshaping can be performed with <code><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt()</a></code>
from the <code>data.table</code> package:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="va">timssLong2</span><span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="va">data.timss3</span><span class="op">)</span>, </span>
<span>                id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IDSTUD"</span>, <span class="st">"TOTWGT"</span>, <span class="st">"JKZONE"</span>, <span class="st">"JKREP"</span>, <span class="st">"female"</span><span class="op">)</span>, </span>
<span>                measure <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/patterns.html" class="external-link">patterns</a></span><span class="op">(</span><span class="st">"^ASMMAT"</span>, <span class="st">"^ASSSCI"</span><span class="op">)</span>, </span>
<span>                value.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"math"</span>, <span class="st">"science"</span><span class="op">)</span>, variable.name<span class="op">=</span><span class="st">"imp"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="main-functions-of-eatrep">2. Main functions of “eatRep”<a class="anchor" aria-label="anchor" href="#main-functions-of-eatrep"></a>
</h2>
<p>The four main functions can be seen as “replication variants” of the
base <code>R</code> functions <code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>, <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code>,
<code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile()</a></code>, and <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code>:</p>
<ol style="list-style-type: decimal">
<li><p><code><a href="../reference/repMean.html">repMean()</a></code>: computes means, standard deviations, mean
differences, and standard deviation differences</p></li>
<li><p><code><a href="../reference/repTable.html">repTable()</a></code>: computes frequency tables and
differences thereof</p></li>
<li><p><code><a href="../reference/repQuantile.html">repQuantile()</a></code> for quantiles, percentiles, and so
on</p></li>
<li><p><code><a href="../reference/repGlm.html">repGlm()</a></code>: linear and generalized linear regression
models</p></li>
</ol>
<div class="section level3">
<h3 id="mean-analysis">2.1 Mean analysis<a class="anchor" aria-label="anchor" href="#mean-analysis"></a>
</h3>
<p>For the first example, we want to compute means and standard
deviations (along with their standard errors) in reading competencies
for several federal states at one distinct time of measurement (2010).
As <code>bt</code> contains data from 2010 and 2015 as well as both
competencies reading and listening, we subset the data set:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt2010</span>     <span class="op">&lt;-</span> <span class="va">bt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">bt</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2010</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">bt2010read</span> <span class="op">&lt;-</span> <span class="va">bt2010</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">bt2010</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>We now call <code><a href="../reference/repMean.html">repMean()</a></code> with the reduced data set
<code>bt2010read</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>           progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<p>We use <code>country</code> as a grouping variable—all analyses are
computed for each country separately. Important: persons in the data
must be nested within the grouping variable. This is true for
<code>country</code>; each person belongs to only one federal state. For
another possible grouping variable, <code>domain</code>, this is not the
case, as one single person may have worked on items from more than one
domain. To check whether persons are nested within a grouping variable,
the function <code>isNested()</code> from the <code>lme4</code> package
package can be called:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reformulas/man/isNested.html" class="external-link">isNested</a></span><span class="op">(</span><span class="va">bt2010</span><span class="op">[</span>,<span class="st">"idstud"</span><span class="op">]</span>, <span class="va">bt2010</span><span class="op">[</span>,<span class="st">"country"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reformulas/man/isNested.html" class="external-link">isNested</a></span><span class="op">(</span><span class="va">bt2010</span><span class="op">[</span>,<span class="st">"idstud"</span><span class="op">]</span>, <span class="va">bt2010</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>To conduct the analyses for both domains in a single call, we
recommend using a loop, according to “listening” and “reading”. We
demonstrate this usage in section 2.5. To collect the results in a
single <code>data.frame</code> which can be exported to excel, for
example, the reporting function <code><a href="../reference/report.html">report2()</a></code> should be
called.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resReading</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>To simplify the graphical visualization of the results using the <a href="https://nickhaf.github.io/eatPlot/" class="external-link">eatPlot</a> package, a new
reporting function called <code><a href="../reference/report.html">report2()</a></code> was introduced. If you
are only interested in a tabular representation of the results, it is
sufficient to simply extract the “plain” worksheet from the list object
returned by the function. The old reporting function is still included
in the package but deprecated. The argument <code>add</code> augments
the output with additional columns. The function does not know that the
analysis is about “reading” competence. If this information should be
incorporated in the output, the <code>add</code> argument allows to
define one or multiple additional columns with scalar information of
character type, for example:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resReading</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="st">"reading"</span>, year <span class="op">=</span> <span class="st">"2010"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The analysis above includes one grouping variable (“country”) and one
competence domain (“reading”) without any group comparisons. The output
therefore is rather sparse.</p>
<p>However, the results can be computed according to more than one
grouping variable. If the results should be computed for each country
and each migration group, both are specified as grouping variables:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"mig"</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>           progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Frequently, one might not only be interested in group means but also
the total mean. Hence, we want to know the mean of each single country
<em>and</em> the mean of the whole population. You can repeat the
analysis two times, one including grouping variables and one ignoring
all grouping variables, but it is easier to use only one single
call:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, </span>
<span>           dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 analyse(s) overall according to: 'group.splits = 0 1'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                     NA</span></span>
<span><span class="co">##                2               1           country                   NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The argument Argument <code>group.splits</code> defines “hierarchy
levels” for the analyses, indicating whether the analysis should be
conducted within or across groups. The number of hierarchy levels always
equals the number of grouping variables plus one. One grouping variable
means two hierarchy levels, two grouping variables mean three levels,
and so on. Without any grouping variables, only one level, the “zeroth”
level, exists. At the zeroth level, no differentiation takes place; all
statistics are computed for the whole population. With one grouping
variable (<code>country</code>, for example) two levels can be defined:
at the zeroth level, statistics are computed for the whole population,
and at the first level, statistics are computed for
<code>countryA</code>, <code>countryB</code>, and <code>countryC</code>
separately. With two grouping variables (<code>country</code> and
migration background: <code>mig</code>), three hierarchy levels are
defined. The entire group (zeroth level), statistics computed for
<code>countryA</code>, <code>countryB</code>, and <code>countryC</code>
(first level, according to <code>country</code>), statistics computed
for <code>no migration background</code> and
<code>migration background</code> (first level, according to
<code>mig</code>), and at the second level, statistics separately
computed for migrants in <code>countryA</code>, migrants in
<code>countryB</code>, migrants in <code>countryB</code>, natives in
<code>countryA</code>, natives in <code>countryB</code>, natives in
<code>countryC</code>. <code>group.splits</code> is a numeric vector
which contains all desired hierarchy levels. Without specifying
<code>group.splits</code>, only the highest hierarchy level is
considered for analysis.</p>
<p>Assume only one grouping variable. <code>group.splits = c(0,1)</code>
or <code>group.splits = 0:1</code> additionally computes statistics for
the zeroth level. For two grouping variables,
<code>group.splits = 1:2</code> computes statistics for the first and
second level. The zeroth level is omitted. To yield statistics for all
possible level, type <code>group.splits = 0:x</code>, where “x” equals
the number of grouping variables.</p>
</div>
<div class="section level3">
<h3 id="group-differences-in-means">2.2 Group differences in means<a class="anchor" aria-label="anchor" href="#group-differences-in-means"></a>
</h3>
<p>Do boys and girls significantly differ in their mean competencies? Do
Bavarian students outperform Saxonian students in “reading”? Is the mean
score of Canadian students significantly above the OECD average? These
examples can be distinguished regarding whether both units, which should
be compared, share the same hierarchy level. Differences within a
hierarchy level (e.g., boys vs. girls) are referred to as “group
differences”. Differences between (adjacent) hierarchy levels (e.g.,
Canadian vs. OECD average, as Canada itself is part of the OECD average)
are referred to as “cross-level differences”. The following example
deals with group differences according to <code>sex</code>—we compare,
whether boys and girls significantly differ in their means:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"sex"</span>, group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, </span>
<span>           dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The argument <code>group.differences.by</code> defines the grouping
variable for which differences should be computed. Note that only one
variable can be specified in <code>group.differences.by</code>, and this
variable must also occur in <code>groups</code> (which may, however,
contain further variables). All pairwise contrasts are computed for the
levels in the <code>group.differences.by</code>-variable. If the
grouping variable is dichotomous with two levels (boys, girls), only one
contrast (boys vs. girls) can be defined. If the grouping variable is
polytomous with three levels (for example, <code>country</code> with
countryA, countryB, countryC), three contrasts will be computed
(countryA vs. countryB, countryA vs. countryC, countryB vs. countryC). A
polytomous variable with four levels defines six contrasts, and so on.
If <code>groups</code> includes more than one variable,
<code>group.differences.by</code> defines for which of these variables
group differences should be computed. If sex differences should be
computed for each country separately, consider the following call:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Compute sex differences in each country and additionally for the
whole group:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country                 &lt;NA&gt;</span></span>
<span><span class="co">##                3               1               sex                  sex</span></span>
<span><span class="co">##                4               2     country + sex                  sex</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Compute country differences within each sex group and additionally
for the whole group:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"country"</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cross-level-differences-in-means">2.3 cross-level differences in means<a class="anchor" aria-label="anchor" href="#cross-level-differences-in-means"></a>
</h3>
<p>For the easiest case, assume only one grouping variable
(<code>sex</code> with levels <code>boys</code> and <code>girls</code>)
and two hierarchy levels—the zeroth and the first level. Cross-level
differences then refer to the difference of one group mean (e.g.,
<code>boys</code> mean) and the total mean. With two or more grouping
variables, cross-level differences can be thought of differences of one
distinct group with all higher-ranking hierarchy levels. Assuming two
grouping variables (<code>country</code> with three levels, and
migration background <code>mig</code> with two levels), 23 cross-level
differences are theoretically possible:</p>
<p><strong>level 2 vs. level 1:</strong></p>
<ul>
<li>migrants in countryA vs. migrants</li>
<li>migrants in countryB vs. migrants</li>
<li>migrants in countryC vs. migrants</li>
<li>natives in countryA vs. natives</li>
<li>natives in countryB vs. natives</li>
<li>natives in countryC vs. natives</li>
<li>migrants in countryA vs. countryA</li>
<li>migrants in countryB vs. countryB</li>
<li>migrants in countryC vs. countryC</li>
<li>natives in countryA vs. countryA</li>
<li>natives in countryB vs. countryB</li>
<li>natives in countryC vs. countryC</li>
</ul>
<p><strong>level 1 vs. level 0:</strong></p>
<ul>
<li>migrants vs. whole population</li>
<li>natives vs. whole population</li>
<li>countryA vs. whole population</li>
<li>countryB vs. whole population</li>
<li>countryC vs. whole population</li>
</ul>
<p><strong>level 2 vs. level 0:</strong></p>
<ul>
<li>migrants in countryA vs. whole population</li>
<li>migrants in countryB vs. whole population</li>
<li>migrants in countryC vs. whole population</li>
<li>natives in countryA vs. whole population</li>
<li>natives in countryB vs. whole population</li>
<li>natives in countryC vs. whole population</li>
</ul>
<p>Each cross-level difference “connects” two hierarchy levels.
Hierarchy levels are neighboring, if their difference equals 1. Levels 2
and 1 are neighboring, but levels 2 and 0 are not. To compute
cross-level differences, <code>group.splits</code> must be specified as
a numeric vector of at least two distinct elements. To reduce number of
cross-level differences, the argument <code>cross.differences</code>
allows to define for which pairs of hierarchy levels cross-level
differences should be computed.</p>
<p>To give an example: Consider both grouping variables
<code>country</code> (3 levels) and <code>mig</code> (2 levels). Means
should be computed for each of the three hierarchy levels. Group
differences should be computed for the <code>country</code> variable
(e.g., countryA vs. countryB, countryA vs. countryC, and countryB
vs. countryC). Cross-level differences should be computed only in
relation to the zeroth level, e.g. level 1 vs. level 0, and level 2
vs. level 0. The following command should be called:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"country"</span>, cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Warning in repMeanList(datL = datL, a = a): Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
<p><code>cross.differences</code> requests a list of numeric vectors
with distinct elements each. Each vector must consist of two integers,
specifying the hierarchy levels for which cross-differences should be
computed. For simplicity, <code>cross.differences = TRUE</code> requests
all possible cross-level differences. Conversely,
<code>cross.differences = FALSE</code> omits all cross-level
differences.</p>
<p>Combining <code>group.differences.by</code> and
<code>cross.differences</code> allows to compute cross-level differences
of group differences, for example, if researchers want to know whether
the difference “boys vs. girls” in “countryA” differs from the
difference “boys vs. girls” in the total population. Note that we
explicitly assume heteroscedastic variance in cross-level difference
estimation by setting <code>hetero = TRUE</code> and
<code>clusters = "idclass"</code>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="cn">TRUE</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>           progress <span class="op">=</span> <span class="cn">FALSE</span>, clusters <span class="op">=</span> <span class="st">"idclass"</span>, hetero <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country                 &lt;NA&gt;</span></span>
<span><span class="co">##                3               1               sex                  sex</span></span>
<span><span class="co">##                4               2     country + sex                  sex</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Compute cross level differences using 'wec' method. Assume heteroscedastic variances.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 32 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 60 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 40 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 91 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
<p>In the output data.frame created by <code><a href="../reference/report.html">report2()</a></code>,
cross-level differences of group differences are marked with the entry
<code>crossDiff_of_groupDiff</code> in the <code>comparison</code>
column.</p>
</div>
<div class="section level3">
<h3 id="statistical-remarks">2.4 Statistical remarks<a class="anchor" aria-label="anchor" href="#statistical-remarks"></a>
</h3>
<p>For cross-level differences, the groups are not independent—when
comparing <code>countryA</code> with the whole population, one must
consider that <code>countryA</code> is part of the whole population.
Hence, a <em>t</em> test is not appropriate. <code>eatRep</code>
supports “weighted effect coding” <span class="citation">(Grotenhuis et
al., 2017; Weirich et al., 2021)</span> or replication methods (e.g,
bootstrap), with “weighted effect coding” (wec) being the default.
Alternative methods can be chosen with the <code>crossDiffSE</code>
argument. The method <code>old</code> uses an inappropriate <em>t</em>
test and should not be used. The method is maintained in the package to
provide compatibility with older versions.</p>
</div>
<div class="section level3">
<h3 id="trend-analyses">2.5 Trend analyses<a class="anchor" aria-label="anchor" href="#trend-analyses"></a>
</h3>
<p>In general, trends are just group differences. If the groups are
distinct, persons are nested within the trend variable (each person
belongs to solely one point in time). The major factor distinguishing
trends from “conventional” group differences is the item sample: For
group differences, the item sample is usually identical, for trends,
this is not necessarily the case. Moreover, comparisons across different
points in time run the risk of being affected by differential item
functioning (DIF) or item parameter drift (IPD). If DIF can be
considered as random, it should be incorporated into the computation of
standard errors of trend estimates. If standard error of trend estimates
should be computed, <code>eatRep</code> allows to take the “linking
error” according to differently functioning items into account.</p>
<p>When computing trends, the analysis is conducted in both cohorts (for
example, 2010 and 2015) separately. Afterwards, for each combination of
grouping variables, the difference
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>m</mi><mo accent="true">‾</mo></mover><mn>2015</mn></msub><mo>−</mo><msub><mover><mi>m</mi><mo accent="true">‾</mo></mover><mn>2010</mn></msub></mrow><annotation encoding="application/x-tex">\bar{m}_{2015}-\bar{m}_{2010}</annotation></semantics></math>
is estimated. The standard error of this difference is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>E</mi><mrow><mi>t</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo>=</mo><msqrt><mrow><mi>S</mi><msubsup><mi>E</mi><mn>2010</mn><mn>2</mn></msubsup><mo>+</mo><mi>S</mi><msubsup><mi>E</mi><mn>2015</mn><mn>2</mn></msubsup><mo>+</mo><mi>S</mi><msubsup><mi>E</mi><mrow><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi></mrow><mn>2</mn></msubsup></mrow></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
SE_{trend}=\sqrt{SE_{2010}^2+SE_{2015}^2+SE_{link}^2}. 
\end{equation}</annotation></semantics></math></p>
<p>Trends can be computed for simple means, group differences, and
cross-level differences. For illustration the last analysis now will be
repeated with additional trend estimation. The former used data object
<code>bt2010read</code> cannot be used any longer as only 2010 data are
included. We use “reading competence” for 2010 and 2015 by subsetting
the <code>bt</code> data. In the function call, the trend variable
<code>trend = "year"</code> as well as the linking error
<code>linkErr = "leScore"</code> have to be defined. Without specifying
the <code>linkErr</code> argument, the linking error is defaulted to
0.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">btread</span>  <span class="op">&lt;-</span> <span class="va">bt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">bt</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">btread</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>           group.differences.by <span class="op">=</span> <span class="st">"country"</span>, cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           dependent <span class="op">=</span> <span class="st">"score"</span>, trend <span class="op">=</span> <span class="st">"year"</span>, linkErr <span class="op">=</span> <span class="st">"leScore"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Warning in repMeanList(datL = datL, a = a): Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span>     <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="loops-across-non-nested-grouping-variables">2.6 Loops across non-nested (grouping) variables<a class="anchor" aria-label="anchor" href="#loops-across-non-nested-grouping-variables"></a>
</h3>
<p>Arguments <code>groups</code> and <code>group.splits</code> allow to
analyze different groups and different hierarchy levels with just one
single call. Alternatively, <code><a href="../reference/repMean.html">repMean()</a></code> may be called two
times, once without grouping variable(s), and one with additional
grouping variable(s). The argument <code>groups</code> requires that
individuals are nested within grouping variables. Individuals, however,
are not nested within competence domains (“reading” and
“listening”)—<code>domain</code> cannot be used as grouping variable.
Alternatively, if both domains should be analyzed with one single call,
an additional outer loop is necessary. We demonstrate this procedure
with exemplary data <code>bt</code>, containing both domains “reading”
and “listening”. As in the example before, we analyze group,
cross-level, and trend differences.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bt</span>, INDICES <span class="op">=</span> <span class="va">bt</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">subsample</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">subsample</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>                    repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>                    group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, group.differences.by <span class="op">=</span> <span class="st">"country"</span>, </span>
<span>                    cross.differences <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="st">"score"</span>, </span>
<span>                    trend <span class="op">=</span> <span class="st">"year"</span>, linkErr <span class="op">=</span> <span class="st">"leScore"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">}</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Warning in repMeanList(datL = datL, a = a): Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 4 analyse(s) overall according to: 'group.splits = 0 1 2'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by</span></span>
<span><span class="co">##                1               0                                   &lt;NA&gt;</span></span>
<span><span class="co">##                2               1           country              country</span></span>
<span><span class="co">##                3               1               sex                 &lt;NA&gt;</span></span>
<span><span class="co">##                4               2     country + sex              country</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Warning in repMeanList(datL = datL, a = a): Computation of cross level differences using 'wec' method is only possible for differences according to adjacent levels. Non-adjacent levels will be ignored.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## Note: No linking error was defined. Linking error will be defaulted to '0'.</span></span></code></pre>
<p>The <code>by</code>-loop around <code>repMean</code> splits the data
in two subsets which are analyzed consecutively. The
<code>results</code> object is a list with two elements, “listening” and
“reading”. The reporting function must be called for these two list
elements separately. We now see that the argument <code>add</code> can
help to distinguish both resulting data.frames. First, the processing is
demonstrated without using a loop:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "listening" "reading"</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resultsListening</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"listening"</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb <span class="op">=</span> <span class="st">"listening"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resultsReading</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"reading"</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults1</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span><span class="va">resultsListening</span>, <span class="va">resultsReading</span><span class="op">)</span></span></code></pre></div>
<p>Using a loop shortens the call, especially if more than two
competence domains are used:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults2</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">x</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>                           <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for 'crossDiff_of_groupDiff' is currently not supported.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Standard error correction for crossDifferences across multiple hierarchy levels is currently not supported.</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults2</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">allResults2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusted-means">2.7 Adjusted means<a class="anchor" aria-label="anchor" href="#adjusted-means"></a>
</h3>
<p><code>eatRep</code> also allows to compute “adjusted” means <span class="citation">(Mayer et al., 2016; Nachtigall et al., 2008)</span>.
We will not elaborate on theoretical issues about adjusted means—broadly
speaking, unadjusted comparisons between two countries, say, Japan and
Vietnam, may be difficult to interpret, because both countries differ
substantially in terms of mean socio-economical status, migration
background, and other background variables. Adjusted means can be
thought of as weighted means to answer the question: would both
countries still differ in their mean competencies, if the distribution
of background variables would be equal? The researcher is free to select
which background or demographic variables should be chosen for
adjustment.</p>
<p>We demonstrate the computation of adjusted means for the domain
“reading” in 2010, where we adjust for <code>sex</code>, migration
background (<code>mig</code>) and socio-economical status
(<code>ses</code>). All variables selected for adjustment must be
numeric. For polytomous variables (e.g., language at home: “german”,
“german and another language”, “only another language”) dichotomous
indicator variables must be generated beforehand. In the following
example, we transform the non-numeric adjustment variables
<code>sex</code> and <code>mig</code> to be numeric.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bt2010read</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"mig"</span>, <span class="st">"ses"</span><span class="op">)</span><span class="op">]</span>, <span class="va">class</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##       sex       mig       ses </span></span>
<span><span class="co">##  "factor" "logical" "numeric"</span></span></code></pre>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt2010read</span><span class="op">[</span>,<span class="st">"sexnum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">bt2010read</span><span class="op">[</span>,<span class="st">"sex"</span><span class="op">]</span>, <span class="st">"'male'=0; 'female'=1"</span>, </span>
<span>                         as.factor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">bt2010read</span><span class="op">[</span>,<span class="st">"mignum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bt2010read</span><span class="op">[</span>,<span class="st">"mig"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>           repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, group.splits <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, </span>
<span>           cross.differences <span class="op">=</span> <span class="cn">TRUE</span>, adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sexnum"</span>, <span class="st">"mignum"</span>, <span class="st">"ses"</span><span class="op">)</span>, </span>
<span>           dependent <span class="op">=</span> <span class="st">"score"</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in repMeanList(datL = datL, a = a): To date, for adjusted means, cross-level differences can only be computed with method 'old'. Set 'crossDiffSE' to 'old'.</span></span>
<span><span class="co">## 2 analyse(s) overall according to: 'group.splits = 0 1'.</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##  analysis.number hierarchy.level groups.divided.by group.differences.by adjust</span></span>
<span><span class="co">##                1               0                                     NA  FALSE</span></span>
<span><span class="co">##                2               1           country                   NA   TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">results</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Please note that, to date, cross-level differences for adjusted means
can only be computed using the methods <code>old</code>. In the zeroth
hierarchy level, no adjustment takes place. As the distribution of
background variables in the total population is used as the reference
for the adjusted group means, the adjusted population mean is equal to
the unadjusted population mean.</p>
<p>If trends should be computed for adjusted means, the procedure
sketched above cannot be adopted without further ado. If the adjusted
mean of <code>countryA</code> in 2015 should be compared with the
adjusted mean of <code>countryA</code> in 2010, the reference group is
no longer the total population (e.g., all countries). Unadjusted means
do no depend on the specific research questions, but for adjusted means,
the research questions matters: Does <code>countryA</code> in 2015
differ from <code>countryB</code> in 2015? Or does <code>countryA</code>
in 2010 differ from <code>countryA</code> in 2015? Both questions
require different adjustment approaches.</p>
<p>In the previous section, the adjustment for only one time of
measurement was sketched: Would Japan still differ from Vietnam, if the
distribution of background variables were equivalent? For trend
analyses, the research question could be: Would there be differences
between 2010 and 2015 for Japan, if the composition of students
according to some demographic variables would not have changed? The
package <code>eatRep</code> does not differentiate between both types of
research questions. To compute adjusted trends, the formerly known trend
variable <code>year</code> must be used as grouping variable. If
adjusted trends for different groups should be estimated, the subsetting
according to groups must be done by hand or via an outer loop. The
incorporation of linking errors, if desired, must be done by hand
likewise. The following example illustrates the procedure. The standard
error of the trend estimate is computed as the square root of the sum of
the squared standard errors for 2010, 2015 and the link:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">btread</span>  <span class="op">&lt;-</span> <span class="va">bt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">bt</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">btread</span><span class="op">[</span>,<span class="st">"sexnum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">btread</span><span class="op">[</span>,<span class="st">"sex"</span><span class="op">]</span>, <span class="st">"'male'=0; 'female'=1"</span>, as.factor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">btread</span><span class="op">[</span>,<span class="st">"mignum"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">btread</span><span class="op">[</span>,<span class="st">"mig"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">btread</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">btread</span><span class="op">[</span>,<span class="st">"year"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">btread</span>,  INDICES <span class="op">=</span> <span class="va">btread</span><span class="op">[</span>,<span class="st">"country"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">sub.dat</span><span class="op">)</span> <span class="op">{</span></span>
<span>           <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repMean.html">repMean</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">sub.dat</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>                  repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span>, </span>
<span>                  adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sexnum"</span>, <span class="st">"mignum"</span>, <span class="st">"ses"</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="st">"score"</span>,</span>
<span>                  progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>           <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">res</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb<span class="op">=</span><span class="st">"reading"</span>, </span>
<span>                          country<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sub.dat</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"country"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span>
<span>           <span class="va">res</span><span class="op">[</span>,<span class="st">"trend"</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span>,<span class="st">"est"</span><span class="op">]</span><span class="op">)</span></span>
<span>           <span class="va">res</span><span class="op">[</span>,<span class="st">"trendSE"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span>,<span class="st">"se"</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sub.dat</span><span class="op">[</span>,<span class="st">"leScore"</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>           <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 62 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 65 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 48 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">results</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="frequency-analyses-reptable">3. Frequency analyses (repTable)<a class="anchor" aria-label="anchor" href="#frequency-analyses-reptable"></a>
</h2>
<p>Univariate frequency analyses of polytomous variables can be thought
of mean analyses of dichotomous indicator variables.
<code><a href="../reference/repTable.html">repTable()</a></code> would not be necessary then—for example, you can
redefine a 5-level polytomous variable into five dichotomous indicators
and call <code><a href="../reference/repMean.html">repMean()</a></code> five times. The main differences between
frequency and mean analyses is the underlying statistic for group
differences: mean analyses typically uses a <em>t</em> test for
independent samples (e.g., “Differ males and females in their mean
reading competencies?”). Frequency tables, however, use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
tests, for example (“Differ males and females in their distribution of
competence levels?”). In theory, you can test for each competence level
1, 2, 3, 4, and 5 with a separate <em>t</em> test, whether males and
females differ. The comparisons, however, are not independent—a
Bonferroni correction might be appropriate then. In the following, both
variants are sketched:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### first example: group comparisons with a chi^2-Test: we check for each country </span></span>
<span><span class="co">### whether the distribution of competence levels differs between males and females</span></span>
<span><span class="va">freq1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repTable.html">repTable</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>         repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>         group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, dependent <span class="op">=</span> <span class="st">"comp"</span>, </span>
<span>         chiSquare <span class="op">=</span> <span class="cn">TRUE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">freq1</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>In the second example, the group comparisons are conducted applying
five separate <em>t</em> tests. For each country and each single
competence level, <code><a href="../reference/repTable.html">repTable()</a></code> checks whether the
distribution differs between males and females. Technically,
<code><a href="../reference/repMean.html">repMean()</a></code> is called five times consecutively.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">freq2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repTable.html">repTable</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>         repInd<span class="op">=</span><span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, </span>
<span>         cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, dependent <span class="op">=</span> <span class="st">"comp"</span>, chiSquare <span class="op">=</span> <span class="cn">FALSE</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">freq2</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> kb <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>In <code><a href="../reference/repTable.html">repTable()</a></code>, the computation of cross-level
differences and trends works analogously to <code><a href="../reference/repMean.html">repMean()</a></code>.</p>
<div class="section level3">
<h3 id="looping-across-several-dependent-variables">3.1 Looping across several dependent variables<a class="anchor" aria-label="anchor" href="#looping-across-several-dependent-variables"></a>
</h3>
<p>Section 2.5 demonstrates the use of <code><a href="https://rdrr.io/r/base/by.html" class="external-link">by()</a></code> loops to
analyze more than one domain with one single call. The same principle
works for several dependent variables within one domain. Suppose you
have several dichotomous criteria (e.g. “failed to reach minimal
standard”, “pass regular standard”, “pass optimal standard”),
represented by several variables. A <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> loop ca be
applied then:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### abhaengige Variablen definieren</span></span>
<span><span class="va">DVs</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"failMin"</span>, <span class="st">"passReg"</span>, <span class="st">"passOpt"</span><span class="op">)</span></span>
<span><span class="va">freq3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">DVs</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">dv</span><span class="op">)</span> <span class="op">{</span> </span>
<span>         <span class="fu"><a href="../reference/repTable.html">repTable</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>            repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>            group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            dependent <span class="op">=</span> <span class="va">dv</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<p>The reporting function <code><a href="../reference/report.html">report()</a></code> must be called three
times, likewise in a <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> loop:</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults3</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">freq3</span>, <span class="va">report</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nested-loops">3.2 Nested loops<a class="anchor" aria-label="anchor" href="#nested-loops"></a>
</h3>
<p>Both types of loops (across non-nested grouping variables and across
several dependent variables) may be combined. In the following example,
we want to analyze three dependent variables for two domains. Hence, a
two-stage loop for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>2</mn><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">3\times 2=6</annotation></semantics></math>
analyses is necessary:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DVs</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"failMin"</span>, <span class="st">"passReg"</span>, <span class="st">"passOpt"</span><span class="op">)</span></span>
<span><span class="va">freq4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">DVs</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">dv</span><span class="op">)</span> <span class="op">{</span> </span>
<span>         <span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span> <span class="op">(</span> data <span class="op">=</span> <span class="va">bt2010</span>, INDICES <span class="op">=</span> <span class="va">bt2010</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sub.dat</span><span class="op">)</span> <span class="op">{</span></span>
<span>               <span class="fu"><a href="../reference/repTable.html">repTable</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">sub.dat</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>                         repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>                         group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                         dependent <span class="op">=</span> <span class="va">dv</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<p>To convert the results in a more user-friendly format:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults4</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">freq4</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">av</span><span class="op">)</span> <span class="op">{</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">av</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">x</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>                         <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">av</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">allResults4</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">allResults4</span><span class="op">)</span></span></code></pre></div>
<p>A combination of two loops also works for trend analyses. Please note
that each dependent variable potentially has its own linking error. If
so, one solution is to store the variable name along with its linking
error in a <code>data.frame</code> and use an <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply()</a></code>
loop:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### two-stage nested loop with trend analysis</span></span>
<span><span class="co">### first we define the dependent variables (dv) and their linking errors (le)</span></span>
<span><span class="va">DVs</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span> <span class="op">(</span> dv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"failMin"</span>, <span class="st">"passReg"</span>, <span class="st">"passOpt"</span><span class="op">)</span>, </span>
<span>                      le <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"leFailMin"</span>, <span class="st">"lePassReg"</span>, <span class="st">"lePassOpt"</span><span class="op">)</span>, </span>
<span>                      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">freq5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">DVs</span>, MARGIN <span class="op">=</span> <span class="fl">1</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">depVars</span><span class="op">)</span> <span class="op">{</span> </span>
<span>         <span class="va">f4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span> <span class="op">(</span> data <span class="op">=</span> <span class="va">bt</span>, INDICES <span class="op">=</span> <span class="va">bt</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sub.dat</span><span class="op">)</span> <span class="op">{</span></span>
<span>               <span class="fu"><a href="../reference/repTable.html">repTable</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">sub.dat</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>                         repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"sex"</span><span class="op">)</span>, </span>
<span>                         group.differences.by <span class="op">=</span> <span class="st">"sex"</span>, cross.differences <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                         trend <span class="op">=</span> <span class="st">"year"</span>, dependent <span class="op">=</span> <span class="va">depVars</span><span class="op">[[</span><span class="st">"dv"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                         linkErr <span class="op">=</span> <span class="va">depVars</span><span class="op">[[</span><span class="st">"le"</span><span class="op">]</span><span class="op">]</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 2'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span></code></pre>
<p>To convert the results in a more user-friendly format:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">freq5</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">av</span><span class="op">)</span> <span class="op">{</span> </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">av</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">x</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>                          <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">av</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>kb<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): Found 6 missing linking errors for dependent variable 'failMin' and parameter(s) 'NcasesValid'. Assume linking error of 0 for these cases.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Found 6 missing linking errors for dependent variable 'passReg' and parameter(s) 'NcasesValid'. Assume linking error of 0 for these cases.</span></span>
<span><span class="co">## Warning in FUN(X[[i]], ...): Found 6 missing linking errors for dependent variable 'passOpt' and parameter(s) 'NcasesValid'. Assume linking error of 0 for these cases.</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allResults5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">allResults5</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analyses-of-ranges-repquantile">4. Analyses of ranges (repQuantile)<a class="anchor" aria-label="anchor" href="#analyses-of-ranges-repquantile"></a>
</h2>
<p>When analyzing quartiles, quantiles or percentiles, please note that
the computation of group differences is not supported yet.
<code>repQuantile</code> requires to specify the probabilities via the
<code>probs</code> argument. The following example illustrates the usage
of the function for the domain “reading” for 2010 and 2015. We compute
the 5., 10., 25., 75., 90., and 95. percentile:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">btRead</span> <span class="op">&lt;-</span> <span class="va">bt</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">bt</span><span class="op">[</span>,<span class="st">"domain"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"reading"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">quan</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repQuantile.html">repQuantile</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">btRead</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>               repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>, trend <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>               dependent <span class="op">=</span> <span class="st">"score"</span>, linkErr <span class="op">=</span> <span class="st">"leScore"</span>, </span>
<span>               probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.25</span>, <span class="fl">.75</span>, <span class="fl">.90</span>, <span class="fl">.95</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2010'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Trend group: '2015'</span></span>
<span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 73 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span>    <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report</a></span><span class="op">(</span><span class="va">quan</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="regression-analyses-repglm">5. Regression analyses (repGlm)<a class="anchor" aria-label="anchor" href="#regression-analyses-repglm"></a>
</h2>
<p><code>repGlm</code> allows to estimate linear and logistic regression
models. To date, trend analyses do not incorporate linking errors. The
reporting function <code><a href="../reference/report.html">report()</a></code> optionally allows to print the
results to the console (if <code>printGlm</code> is set to
<code>TRUE</code>). In the first example, the regression of reading
competence on sex, SES is estimated in each country separately. For a
valid interpretation of interaction effects, SES variable is
standardized within each imputation:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt2010read</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">bt2010read</span>, INDICES <span class="op">=</span> <span class="va">bt2010read</span><span class="op">[</span>,<span class="st">"imp"</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span> <span class="va">i</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>                <span class="va">i</span><span class="op">[</span>,<span class="st">"ses_std"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">i</span><span class="op">[</span>,<span class="st">"ses"</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">bt2010read</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">bt2010read</span><span class="op">)</span>              </span>
<span><span class="va">reg1</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repGlm.html">repGlm</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>               repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, groups <span class="op">=</span> <span class="st">"country"</span>,  formula <span class="op">=</span> <span class="va">score</span><span class="op">~</span><span class="va">sex</span><span class="op">*</span><span class="va">ses_std</span>, </span>
<span>               family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 1'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res1</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">reg1</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span>, printGlm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        Trend group: 'noTrend'.</span></span>
<span><span class="co">##             groups: type = point; country = countryA; row = 1; id = 14574361_1</span></span>
<span><span class="co">##             domain: reading</span></span>
<span><span class="co">## dependent Variable: score</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##         parameter     est    se t.value p.value sig</span></span>
<span><span class="co">## 1     (Intercept) 505.837 4.428 114.243   0.000 ***</span></span>
<span><span class="co">## 2         ses_std  23.697 3.876   6.114   0.000 ***</span></span>
<span><span class="co">## 3         sexmale   8.677 5.594   1.551   0.121    </span></span>
<span><span class="co">## 4 sexmale:ses_std   4.109 5.527   0.743   0.457    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             R-squared: 0.115; SE(R-squared): NA</span></span>
<span><span class="co">## 1034 observations and 1030 degrees of freedom.</span></span>
<span><span class="co">## ------------------------------------------------------------------</span></span>
<span><span class="co">##             groups: type = point; country = countryB; row = 4; id = 14574361_4</span></span>
<span><span class="co">##             domain: reading</span></span>
<span><span class="co">## dependent Variable: score</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##         parameter     est    se t.value p.value sig</span></span>
<span><span class="co">## 1     (Intercept) 499.044 4.624 107.934   0.000 ***</span></span>
<span><span class="co">## 2         ses_std  28.344 4.637   6.113   0.000 ***</span></span>
<span><span class="co">## 3         sexmale   7.918 7.804   1.015   0.311    </span></span>
<span><span class="co">## 4 sexmale:ses_std   7.598 5.024   1.512   0.131    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             R-squared: 0.181; SE(R-squared): NA</span></span>
<span><span class="co">## 959 observations and 955 degrees of freedom.</span></span>
<span><span class="co">## ------------------------------------------------------------------</span></span>
<span><span class="co">##             groups: type = point; country = countryC; row = 7; id = 14574361_7</span></span>
<span><span class="co">##             domain: reading</span></span>
<span><span class="co">## dependent Variable: score</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##         parameter     est    se t.value p.value sig</span></span>
<span><span class="co">## 1     (Intercept) 525.240 3.788 138.663   0.000 ***</span></span>
<span><span class="co">## 2         ses_std  24.083 5.246   4.591   0.000 ***</span></span>
<span><span class="co">## 3         sexmale  15.108 5.289   2.856   0.004  **</span></span>
<span><span class="co">## 4 sexmale:ses_std   0.879 7.460   0.118   0.906    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             R-squared: 0.096; SE(R-squared): NA</span></span>
<span><span class="co">## 1086 observations and 1082 degrees of freedom.</span></span></code></pre>
<p>The second example illustrates a logistic regression. Whether or not
the regular standard was passed (<code>passReg</code>) is the dependent
variable. The variable <code>country</code> is now used as a
predictor.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg2</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repGlm.html">repGlm</a></span><span class="op">(</span>datL <span class="op">=</span> <span class="va">bt2010read</span>, ID<span class="op">=</span><span class="st">"idstud"</span>, wgt<span class="op">=</span><span class="st">"wgt"</span>, type<span class="op">=</span><span class="st">"jk2"</span>, PSU<span class="op">=</span><span class="st">"jkzone"</span>, </span>
<span>               repInd <span class="op">=</span> <span class="st">"jkrep"</span>, imp<span class="op">=</span><span class="st">"imp"</span>, formula <span class="op">=</span> <span class="va">passReg</span><span class="op">~</span><span class="va">country</span><span class="op">*</span><span class="va">ses_std</span>, </span>
<span>               family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## 1 analyse(s) overall according to: 'group.splits = 0'.</span></span>
<span><span class="co">## Assume unnested structure with 3 imputations.</span></span>
<span><span class="co">## Create 92 replicate weights according to JK2 procedure.</span></span></code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/report.html">report2</a></span><span class="op">(</span><span class="va">reg2</span>, add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"reading"</span><span class="op">)</span>, printGlm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="st">"plain"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        Trend group: 'noTrend'.</span></span>
<span><span class="co">##             groups: type = point; row = 1; id = 14575099_1</span></span>
<span><span class="co">##             domain: reading</span></span>
<span><span class="co">## dependent Variable: passReg</span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##                 parameter    est    se t.value p.value sig</span></span>
<span><span class="co">## 1             (Intercept) -0.227 0.115  -1.972   0.049   *</span></span>
<span><span class="co">## 2         countrycountryB -0.206 0.156  -1.317   0.188    </span></span>
<span><span class="co">## 3 countrycountryB:ses_std  0.097 0.159   0.613   0.540    </span></span>
<span><span class="co">## 4         countrycountryC  0.465 0.141   3.305   0.001 ***</span></span>
<span><span class="co">## 5 countrycountryC:ses_std -0.086 0.142  -0.604   0.546    </span></span>
<span><span class="co">## 6                 ses_std  0.609 0.082   7.401   0.000 ***</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             R-squared: 0.116; SE(R-squared): NA</span></span>
<span><span class="co">## 3079 observations and 3073 degrees of freedom.</span></span></code></pre>
<p>The output gives the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
(for linear regression models) as well as Nagelkerke’s
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
(for logistic regression models).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-RN11" class="csl-entry">
Davier, M. von, Gonzalez, E., &amp; Mislevy, R. J. (2009). What are
plausible values and why are they useful? [Journal Article]. <em>IERI
Monograph Series: Issues and Methodologies in Large Scale
Assessments</em>, <em>2</em>, 9–36.
</div>
<div id="ref-RN3" class="csl-entry">
Foy, P., Galia, J., &amp; Li, I. (2008). Scaling the data from the TIMSS
2007 mathematics and science asssessment [Book Section]. In J. F. Olson,
M. O. Martin, &amp; I. V. S. Mullis (Eds.), <em>TIMSS 2007 technical
report</em> (pp. 225–280). TIMSS &amp; PIRLS International Study Center,
Lynch School of Education, Boston College.
</div>
<div id="ref-RN416" class="csl-entry">
Grotenhuis, M. te, Pelzer, B., Eisinga, R., Nieuwenhuis, R.,
Schmidt-Catran, A., &amp; Konig, R. (2017). When size matters:
Advantages of weighted effect coding in observational studies [Journal
Article]. <em>International Journal of Public Health</em>, <em>62</em>,
163–167.
</div>
<div id="ref-RN366" class="csl-entry">
Hambleton, R. K., &amp; Jones, R. W. (1993). An NCME instructional
module on: Comparison of classical test theory and item response theory
and their applications to test development [Journal Article].
<em>Educational Measurement: Issues and Practice</em>, <em>12</em>(3),
38–47.
</div>
<div id="ref-RN142" class="csl-entry">
Hambleton, R. K., Swaminathan, H., &amp; Rogers, H. J. (1991).
<em>Fundamentals of item response theory</em> [Book]. Sage.
</div>
<div id="ref-RN487" class="csl-entry">
Krewski, D., &amp; Rao, J. N. K. (1981). Inference from stratified
samples: Properties of the linearization, jackknife and balanced
repeated replication method [Journal Article]. <em>Annals of
Statistics</em>, <em>9</em>, 1010–1019.
</div>
<div id="ref-RN164" class="csl-entry">
Little, R. J. A., &amp; Rubin, D. B. (1987). <em>Statistical analyses
with missing data</em> [Book]. Wiley.
</div>
<div id="ref-RN477" class="csl-entry">
Mayer, A., Dietzfelbinger, L., Rosseel, Y., &amp; Steyer, R. (2016). The
EffectLiteR approach for analyzing average and conditional effects
[Journal Article]. <em>Multivariate Behavioral Research</em>,
<em>51</em>, 374–391.
</div>
<div id="ref-RN6" class="csl-entry">
Mislevy, R. J., Beaton, A. E., Kaplan, B., &amp; Sheehan, K. M. (1992).
Estimating population characteristics from sparse matrix samples of item
responses [Journal Article]. <em>Journal of Educational
Measurement</em>, <em>29</em>, 133–161.
</div>
<div id="ref-RN213" class="csl-entry">
Mislevy, R. J., Johnson, E. G., &amp; Muraki, E. (1992). Scaling
procedures in NAEP [Journal Article]. <em>Journal of Educational and
Behavioral Statistics</em>, <em>17</em>(2), 131–154.
</div>
<div id="ref-RN394" class="csl-entry">
Monseur, C., &amp; Adams, R. (2009). Plausible values: How to deal with
their limitations [Journal Article]. <em>Journal of Applied
Measurement</em>, <em>10</em>(3), 320–334.
</div>
<div id="ref-RN523" class="csl-entry">
Nachtigall, C., Kröhne, U., Enders, U., &amp; Steyer, R. (2008). Causal
effects and fair comparisons: Considering the influence of context
variables on student competencies [Book Section]. In J. Hartig, E.
Klieme, &amp; D. Leutner (Eds.), <em>Assessment of competencies in
educational contexts</em>. Hogrefe &amp; Huber.
</div>
<div id="ref-RN77" class="csl-entry">
Rubin, D. B. (2003). Nested multiple imputation of NMES via partially
incompatible MCMC [Journal Article]. <em>Statistica Neerlandica</em>,
<em>57</em>(1), 3–18.
</div>
<div id="ref-RN421" class="csl-entry">
Rust, K. (2014). Sampling, weighting, and variance estimation [Book
Section]. In L. Rutkowski, M. Von Davier, &amp; D. Rutkowski (Eds.),
<em>Handbook of international large-scale assessment</em>. CRC Press.
</div>
<div id="ref-RN393" class="csl-entry">
Rust, K., &amp; Rao, J. N. K. (1996). Variance estimation for complex
surveys using replication techniques [Journal Article]. <em>Statistical
Methods in Medical Research</em>, <em>5</em>, 283–310.
</div>
<div id="ref-RN557" class="csl-entry">
Weirich, S., Hecht, M., Becker, B., &amp; Zitzmann, S. (2021). Comparing
group means with the total mean in random samples, surveys, and
large-scale assessments: A tutorial and software illustration [Journal
Article]. <em>Behavior Research Methods</em>, 1–12. https://doi.org/<a href="https://doi.org/10.3758/s13428-021-01553-1" class="external-link">https://doi.org/10.3758/s13428-021-01553-1</a>
</div>
<div id="ref-RN603" class="csl-entry">
Wolter, K. M. (2007). <em>Introduction to variance estimation</em>
[Book]. Springer.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sebastian Weirich, Martin Hecht, Karoline Sachse, Benjamin Becker.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
